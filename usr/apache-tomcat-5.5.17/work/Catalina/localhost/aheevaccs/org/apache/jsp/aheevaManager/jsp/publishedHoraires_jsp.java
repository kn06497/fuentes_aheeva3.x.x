package org.apache.jsp.aheevaManager.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import javax.naming.*;
import javax.sql.*;
import java.sql.*;
import java.util.*;
import aheevaManager.wfm_schedule.*;
import aheevaManager.ressources.*;
import java.text.*;
import aheevaManager.schedule.*;
import aheevaManager.ressources.*;
import java.util.*;
import jxl.*;
import java.text.SimpleDateFormat;
import java.util.Date;
import aheevaManager.schedule.*;
import java.text.*;
import aheevaManager.schedule.*;
import aheevaManager.ressources.*;
import aheevaManager.ressources.*;

public final class publishedHoraires_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static java.util.List _jspx_dependants;

  static {
    _jspx_dependants = new java.util.ArrayList(3);
    _jspx_dependants.add("/aheevaManager/jsp/../Resources_pages/xc2_default_labels.jsp");
    _jspx_dependants.add("/aheevaManager/jsp/../Resources_pages/schedFunctions_labels.jsp");
    _jspx_dependants.add("/aheevaManager/jsp/../Resources_pages/weeklycalendar_labels.jsp");
  }

  public Object getDependants() {
    return _jspx_dependants;
  }

  public void _jspService(HttpServletRequest request, HttpServletResponse response)
        throws java.io.IOException, ServletException {

    JspFactory _jspxFactory = null;
    PageContext pageContext = null;
    HttpSession session = null;
    ServletContext application = null;
    ServletConfig config = null;
    JspWriter out = null;
    Object page = this;
    JspWriter _jspx_out = null;
    PageContext _jspx_page_context = null;


    try {
      _jspxFactory = JspFactory.getDefaultFactory();
      response.setContentType("text/html");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("<html>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");

////open connection to database///////
beanManagerData pagePubHoData = new beanManagerData();
System.out.println(session.getAttribute("USER_LANGUAGE"));
if( session.getAttribute("USER_LANGUAGE") != null )
	pagePubHoData.setDefaultLanguage((String)session.getAttribute("USER_LANGUAGE"));
pagePubHoData.openConnection();

      out.write("\n");
      out.write("\r\n");
      out.write("<head>\r\n");
      out.write("<title>AheevaCCS - Group Schedule1</title>\n");
      out.write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\r\n");
      out.write("\r\n");
      out.write("<link id=\"luna-tab-style-sheet\" type=\"text/css\" rel=\"stylesheet\" href=\"../Resources_pages/tab_luna.css\" />\r\n");
      out.write("<link id=\"luna-tab-style-sheet\" type=\"text/css\" rel=\"stylesheet\" href=\"../Resources_pages/style_2.css\" />\r\n");
      out.write("\r\n");
      out.write("<LINK href=\"../Resources_pages/style.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("<link rel=\"stylesheet\" href=\"../Resources_pages/xc2_default.css\" type=\"text/css\">\r\n");
      out.write("\r\n");
      out.write("<script language=\"javascript\" type=\"text/javascript\" src=\"../Resources_pages/tabpane.js\"></script>\r\n");
      out.write("<script language=\"JavaScript\"  type=\"text/javascript\" src=\"../Resources_pages/jsUtil.js\"></script>\r\n");
      out.write("<script language=\"JavaScript\">\r\n");
      out.write("var lang =normalizeString(QueryString('lang'));\r\n");
      out.write("</script>\r\n");
      out.write("<style type=\"text/css\">\r\n");
      out.write(".dynamic-tab-pane-control .tab-page {\r\n");
      out.write("\theight:\t\t100%;\r\n");
      out.write("\t\r\n");
      out.write("\r\n");
      out.write("\t/*width:      550px;*/\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("html, body {\r\n");
      out.write("\tbackground:\t#E1F4FF;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("form {\r\n");
      out.write("\tmargin:\t\t0;\r\n");
      out.write("\tpadding:\t0;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("/* over ride styles from webfxlayout */\r\n");
      out.write("\r\n");
      out.write("body {\r\n");
      out.write("\tmargin:\t\t10px;\r\n");
      out.write("\twidth:\t\tauto;\r\n");
      out.write("\theight:\t\tauto;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".dynamic-tab-pane-control h2 {\r\n");
      out.write("\ttext-align:\tcenter;\r\n");
      out.write("\twidth:\t\tauto;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".dynamic-tab-pane-control h2 a {\r\n");
      out.write("\tdisplay:\tinline;\r\n");
      out.write("\twidth:\t\tauto;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".dynamic-tab-pane-control a:hover {\r\n");
      out.write("\tbackground: transparent;\r\n");
      out.write("}\r\n");
      out.write(".imgControl {\r\n");
      out.write("\ttop: 1;\r\n");
      out.write("\tposition:\t\trelative;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".skin0{\r\n");
      out.write("position:absolute;\r\n");
      out.write("width:165px;\r\n");
      out.write("border:2px solid black;\r\n");
      out.write("background-color:menu;\r\n");
      out.write("font-family:Verdana;\r\n");
      out.write("line-height:20px;\r\n");
      out.write("cursor:default;\r\n");
      out.write("font-size:14px;\r\n");
      out.write("z-index:100;\r\n");
      out.write("visibility:hidden;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".menuitems{\r\n");
      out.write("padding-left:10px;\r\n");
      out.write("padding-right:10px;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".legendText {\r\n");
      out.write("\tfont:Tahoma;\r\n");
      out.write("\tfont-size:9px;\r\n");
      out.write("\tcolor:#000000\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".menudiv{\r\n");
      out.write("\tposition:absolute;\r\n");
      out.write("\tvisibility:hidden;\r\n");
      out.write("\tz-index:10;\r\n");
      out.write("\theight:20px;\r\n");
      out.write("\twidth:120px;\r\n");
      out.write("\tborder:1px solid;\r\n");
      out.write("\tfont:Verdana, Arial, Helvetica, sans-serif;\r\n");
      out.write("\tfont-size:12px;\r\n");
      out.write("\tfont-weight:bold;\r\n");
      out.write("\tcolor:#000000;\r\n");
      out.write("\t/*\tbackground-image:url(keramik_bubble.gif)*/\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".menudiv2{\r\n");
      out.write("\tposition:absolute;\r\n");
      out.write("\tvisibility:hidden;\r\n");
      out.write("\tz-index:10;\r\n");
      out.write("\theight:20px;\r\n");
      out.write("\t/*width:150px;*/\r\n");
      out.write("\tborder:1px solid;\r\n");
      out.write("\tfont:Verdana, Arial, Helvetica, sans-serif;\r\n");
      out.write("\tfont-size:12px;\r\n");
      out.write("\tfont-weight:bold;\r\n");
      out.write("\tcolor:#000000;\r\n");
      out.write("\t/*\tbackground-image:url(keramik_bubble.gif)*/\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write(".sousmenusched{\r\n");
      out.write("\tz-index:10;\r\n");
      out.write("\tposition:absolute;\r\n");
      out.write("\theight:21px;\r\n");
      out.write("\twidth:80px;\r\n");
      out.write("\tvisibility:hidden;\r\n");
      out.write("\tborder:1px solid black;\r\n");
      out.write("\tborder-style: solid;\r\n");
      out.write("\tborder-color: #000000;\r\n");
      out.write("\tfont:Verdana, Arial, Helvetica, sans-serif;\r\n");
      out.write("\tfont-size:12px;\r\n");
      out.write("\tfont-weight:bold;\r\n");
      out.write("\tbackground-color:#ffffff;\r\n");
      out.write("\tcolor:Black;\r\n");
      out.write("\t/*background-image:url(keramik_bubble.gif);\r\n");
      out.write("\t\t*/\r\n");
      out.write(" }\r\n");
      out.write("\r\n");
      out.write(".changelook{\r\n");
      out.write("\tcolor:#ffffff;\r\n");
      out.write(" }\r\n");
      out.write("\r\n");
      out.write(".paramsDiv{\r\n");
      out.write("  position:absolute;\r\n");
      out.write("  left:100px;\r\n");
      out.write("  top: 25px;\r\n");
      out.write("  font:\t12px Tahoma;\r\n");
      out.write("  color: Black;\r\n");
      out.write(" }\r\n");
      out.write(" \r\n");
      out.write(" .paramsDivText{\r\n");
      out.write("\tfont:\t\t\t12px Tahoma;\r\n");
      out.write("\tcolor:\t\t\tBlack;\r\n");
      out.write("\tfont-weight:    100\r\n");
      out.write("}\r\n");
      out.write("</style>\r\n");
      out.write("\r\n");
      out.write("</head>\r\n");
      out.write("<body>\r\n");
      out.write("\r\n");
      out.write("<div id=\"ie5menu\" class=\"skin0\" onMouseover=\"highlightie5(event)\" onMouseout=\"lowlightie5(event)\" onClick=\"jumptoie5(event)\" display:none>\r\n");
      out.write("<div id=\"day\" class=\"menuitems\" url=\"\"></div>\r\n");
      out.write("<hr>\r\n");
      out.write("<div class=\"menuitems\" url=\"\">");
      out.print( pagePubHoData.getWord("Set absent"));
      out.write("</div>\n");
      out.write("<div class=\"menuitems\" url=\"\">");
      out.print( pagePubHoData.getWord("Shift trade"));
      out.write("</div>\n");
      out.write("</div>\r\n");
      out.write("\r\n");
      out.write("<div id=\"schedmenuAgt\" class=\"menudiv2\" onMouseOver=\"showAgtMenuItems()\" onMouseOut=\"\" align=\"center\"><table width=\"150px\" height=\"100%\" bgcolor=\"#FFFFFF\"  cellspacing=\"0\"><tr><td width=\"25px\" bgcolor=\"#CCCCCC\" align=\"center\"><img src=\"../img/homme_inactive.gif\"></td><td bgcolor=\"#FFFFFF\" align=\"center\"><a id=\"agtName\" style=\"font-size:11px; font-family:Tahoma, Verdana, Arial; color:#669966; font-weight:bold\">");
      out.print( pagePubHoData.getWord("Name"));
      out.write(" </a></td></tr></table> </div>\n");
      out.write("\r\n");
      out.write("<div id=\"schedmenuAgtInfo\" class=\"menudiv2\"  onMouseOver=\"\" onClick=\"showAgtMenuItems1()\" align=\"center\"><table width=\"150px\" height=\"100%\" bgcolor=\"#FFFFFF\"  cellspacing=\"0\"><tr><td width=\"25px\" bgcolor=\"#CCCCCC\" align=\"center\"><img src=\"../img/client.gif\"></td><td bgcolor=\"#FFFFFF\" align=\"center\"><a style=\"font-size:11px; font-family:Tahoma, Verdana, Arial; color:#000000; font-weight:bold\"  onmouseover=\"javascript:this.style.color='blue'\" onMouseOut=\"javascript:this.style.color='black'\" align=\"center\">  ");
      out.print( pagePubHoData.getWord("Info"));
      out.write(" </a></td><td width=\"10%\"><img src=\"../img/arrowmenu.gif\"/></td></tr></table> </div>\n");
      out.write("\r\n");
      out.write("<div id=\"schedmenuAgtInfoItem1\" class=\"menudiv2\" onClick=\"\" align=\"center\"><table width=\"120px\" height=\"100%\" bgcolor=\"#FFFFFF\"  cellspacing=\"0\"><tr align=\"center\"><td bgcolor=\"#FFFFFF\"><a  id=\"agtDetailsInfo\" style=\"font-size:11px; font-family:Tahoma, Verdana, Arial; color:#000000; font-weight:bold\"  onmouseover=\"\" onMouseOut=\"\" align=\"center\">  ");
      out.print( pagePubHoData.getWord("Info"));
      out.write(" </a></td></tr></table> </div>\n");
      out.write("\r\n");
      out.write("<div id=\"schedmenuAgtQuit\" class=\"menudiv2\" onClick=\"return setQuit();\" align=\"center\" ><table width=\"150px\" height=\"100%\" bgcolor=\"#FFFFFF\"  cellspacing=\"0\"><tr><td width=\"25px\" bgcolor=\"#CCCCCC\" align=\"center\"><img src=\"../img/client.gif\"></td><td bgcolor=\"#FFFFFF\" align=\"center\"><a style=\"font-size:11px; font-family:Tahoma, Verdana, Arial; color:#000000; font-weight:bold\"  onmouseover=\"javascript:this.style.color='blue'\" onMouseOut=\"javascript:this.style.color='black'\" align=\"center\">  ");
      out.print( pagePubHoData.getWord("Set quit"));
      out.write(" </a></td><td width=\"10%\"></td></tr></table> </div>\n");
      out.write("\r\n");
      out.write("<script language=\"JavaScript1.2\">\r\n");
      out.write("\r\n");
      out.write("//set this variable to 1 if you wish the URLs of the highlighted menu to be displayed in the status bar\r\n");
      out.write("var nrows = 1 ;\r\n");
      out.write("var maxrow = 1;\r\n");
      out.write("var display_url=0\r\n");
      out.write("var theday='';\r\n");
      out.write("var w=0,y=0,s=0,r=0;\r\n");
      out.write("var aIdArray = new Array();\r\n");
      out.write("var aSunArray = new Array();\r\n");
      out.write("var aMonArray = new Array();\r\n");
      out.write("var aTueArray = new Array();\r\n");
      out.write("var aWedArray = new Array();\r\n");
      out.write("var aThuArray = new Array();\r\n");
      out.write("var aFriArray = new Array();\r\n");
      out.write("var aSatArray = new Array();\r\n");
      out.write("\r\n");
      out.write("var ie5=document.all&&document.getElementById\r\n");
      out.write("var ns6=document.getElementById&&!document.all\r\n");
      out.write("if (ie5||ns6)\r\n");
      out.write("var menuobj=document.getElementById(\"ie5menu\")\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("function change(selectvalue)\r\n");
      out.write("{\r\n");
      out.write("\tvar id = selectvalue.options[ selectvalue.selectedIndex ].value ;\r\n");
      out.write("\tvar chosen;\r\n");
      out.write("\tfor (h=0;h<500;h++){//get the size of the agent list\r\n");
      out.write("\t if (aIdArray[h]==id){\r\n");
      out.write("\t  chosen = h;\r\n");
      out.write("\t  break;\r\n");
      out.write("\t }\r\n");
      out.write("\t}\r\n");
      out.write("\tif (s>=1){\r\n");
      out.write("\t  document.getElementById(\"agent_shift\").removeChild(document.getElementById('s'));\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\tlyr=document.createElement(\"DIV\");\r\n");
      out.write(" \tlyr.id ='s';\r\n");
      out.write("\r\n");
      out.write("        var code='';\r\n");
      out.write("        code =\"<table border='1'><tr>\";\r\n");
      out.write("        ");
      out.write("\r\n");
      out.write("        if (aSunArray[chosen].substring(aSunArray[chosen].length-1, aSunArray[chosen].length) == '1'){\r\n");
      out.write("                code+=\"<td>");
      out.print( pagePubHoData.getWord("Sunday"));
      out.write("&nbsp;<input type='checkbox' name='ab_sunday' value='Sunday' CHECKED></td>\";\n");
      out.write("\r\n");
      out.write("   }else{\r\n");
      out.write("        code+=\"<td>");
      out.print( pagePubHoData.getWord("Sunday"));
      out.write("&nbsp;<input type='checkbox' name='ab_sunday' value='Sunday'></td>\";\n");
      out.write("\r\n");
      out.write("   }\r\n");
      out.write("\r\n");
      out.write("        ");
      out.write("\r\n");
      out.write("        if (aMonArray[chosen].substring(aMonArray[chosen].length-1, aMonArray[chosen].length) == '1'){\r\n");
      out.write("                code+=\"<td>");
      out.print( pagePubHoData.getWord("Monday"));
      out.write("&nbsp;<input type='checkbox' name='ab_monday' value='Monday' checked></td>\";\n");
      out.write("        }else{\r\n");
      out.write("                code+=\"<td>");
      out.print( pagePubHoData.getWord("Monday"));
      out.write("&nbsp;<input type='checkbox' name='ab_monday' value='Monday'></td>\";\n");
      out.write("\r\n");
      out.write("   }\r\n");
      out.write("\r\n");
      out.write("        ");
      out.write("\r\n");
      out.write("        if (aTueArray[chosen].substring(aTueArray[chosen].length-1, aTueArray[chosen].length) == '1'){\r\n");
      out.write("                  code+=\"<td>");
      out.print( pagePubHoData.getWord("Tuesday"));
      out.write("&nbsp;<input type='checkbox' name='ab_tuesday' value='Tuesday' checked></td>\";\n");
      out.write("        }else{\r\n");
      out.write("                  code+=\"<td>");
      out.print( pagePubHoData.getWord("Tuesday"));
      out.write("&nbsp;<input type='checkbox' name='ab_tuesday' value='Tuesday'></td>\";\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        ");
      out.write("\r\n");
      out.write("        if (aWedArray[chosen].substring(aWedArray[chosen].length-1, aWedArray[chosen].length) == '1'){\r\n");
      out.write("                  code+=\"<td>");
      out.print( pagePubHoData.getWord("Wednesday"));
      out.write("&nbsp;<input type='checkbox' name='ab_wednesday' value='Wednesday' checked></td>\";\n");
      out.write("        }else{\r\n");
      out.write("                  code+=\"<td>");
      out.print( pagePubHoData.getWord("Wednesday"));
      out.write("&nbsp;<input type='checkbox' name='ab_wednesday' value='Wednesday'></td>\";\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("\t");
      out.write("\r\n");
      out.write("        if (aThuArray[chosen].substring(aThuArray[chosen].length-1, aThuArray[chosen].length) == '1'){\r\n");
      out.write("        code+=\"<td>");
      out.print( pagePubHoData.getWord("Thursday"));
      out.write("&nbsp;<input type='checkbox' name='ab_thursday' value='Thursday' checked></td>\";\n");
      out.write("        }else{\r\n");
      out.write("                 code+=\"<td>");
      out.print( pagePubHoData.getWord("Thursday"));
      out.write("&nbsp;<input type='checkbox' name='ab_thursday' value='Thursday'></td>\";\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        ");
      out.write("\r\n");
      out.write("        if (aFriArray[chosen].substring(aFriArray[chosen].length-1, aFriArray[chosen].length) == '1'){\r\n");
      out.write("                 code+=\"<td>");
      out.print( pagePubHoData.getWord("Friday"));
      out.write("&nbsp;<input type='checkbox' name='ab_friday' value='Friday' checked></td>\";\n");
      out.write("        }else{\r\n");
      out.write("                 code+=\"<td>");
      out.print( pagePubHoData.getWord("Friday"));
      out.write("&nbsp;<input type='checkbox' name='ab_friday' value='Friday'></td>\";\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        ");
      out.write("\r\n");
      out.write("        if (aSatArray[chosen].substring(aSatArray[chosen].length-1, aSatArray[chosen].length) == '1'){\r\n");
      out.write("        code+=\"<td>");
      out.print( pagePubHoData.getWord("Saturday"));
      out.write("&nbsp;<input type='checkbox' name='ab_saturday' value='Saturday' checked></td>\";\n");
      out.write("        }else{\r\n");
      out.write("        code+=\"<td>");
      out.print( pagePubHoData.getWord("Saturday"));
      out.write("&nbsp;<input type='checkbox' name='ab_saturday' value='Saturday'></td>\";\n");
      out.write("        }\r\n");
      out.write("\t\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\tcode+=\"</tr><tr><td align='left' bgcolor='#e6eff4'>\"+aSunArray[chosen].substring(0,11)+\"</td><td bgcolor='#b4cfff'>\"+aMonArray[chosen].substring(0,11)+\"</td><td bgcolor='#e6eff4'>\"+aTueArray[chosen].substring(0,11)+\"</td>\";\r\n");
      out.write("\tcode+=\"<td align='left' bgcolor='#b4cfff'>\"+aWedArray[chosen].substring(0,11)+\"</td><td bgcolor='#e6eff4'>\"+aThuArray[chosen].substring(0,11)+\"</td><td bgcolor='#b4cfff'>\"+aFriArray[chosen].substring(0,11)+\"</td>\";\r\n");
      out.write("\tcode+=\"<td bgcolor='#e6eff4'>\"+aSatArray[chosen].substring(0,11)+\"</td></tr></table>\";\r\n");
      out.write("\r\n");
      out.write("lyr.innerHTML = code;\r\n");
      out.write("document.getElementById(\"agent_shift\").appendChild(lyr);\r\n");
      out.write("s++;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function affiche(selectvalue)\r\n");
      out.write("{\r\n");
      out.write("\tvar id = selectvalue.options[ selectvalue.selectedIndex ].value ;\r\n");
      out.write("\tvar chosen;\r\n");
      out.write("\tfor (h=0;h<500;h++){//get the size of the agent list\r\n");
      out.write("\t if (aIdArray[h]==id){\r\n");
      out.write("\t  chosen = h;\r\n");
      out.write("\t  break;\r\n");
      out.write("\t }\r\n");
      out.write("\t}\r\n");
      out.write("\tif (r>=1){\r\n");
      out.write("\t  document.getElementById(\"man_shifts\").removeChild(document.getElementById('r'));\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\tdiv=document.createElement(\"DIV\");\r\n");
      out.write(" \tdiv.id ='r';\r\n");
      out.write("\r\n");
      out.write("\tvar code='';\r\n");
      out.write("\tcode =\"<table border='1'><tr bgcolor='#b4cfff'><td>");
      out.print( pagePubHoData.getWord("Sunday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Monday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Tuesday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Wednesday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Thursday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Friday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Saturday"));
      out.write("</td></tr>\";\n");
      out.write("\tcode+=\"<tr><td align='left' bgcolor='#e6eff4'>\"+aSunArray[chosen]+\"</td><td bgcolor='#b4cfff'>\"+aMonArray[chosen]+\"</td><td bgcolor='#e6eff4'>\"+aTueArray[chosen]+\"</td>\";\r\n");
      out.write("\tcode+=\"<td align='left' bgcolor='#b4cfff'>\"+aWedArray[chosen]+\"</td><td bgcolor='#e6eff4'>\"+aThuArray[chosen]+\"</td><td bgcolor='#b4cfff'>\"+aFriArray[chosen]+\"</td>\";\r\n");
      out.write("\tcode+=\"<td bgcolor='#e6eff4'>\"+aSatArray[chosen]+\"</td></tr></table>\";\r\n");
      out.write("\r\n");
      out.write("   \tdiv.innerHTML = code;\r\n");
      out.write("  \tdocument.getElementById(\"man_shifts\").appendChild(div);\r\n");
      out.write("\tr++;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("function bla(selectvalue)\r\n");
      out.write("{\r\n");
      out.write("\tvar id = selectvalue.options[ selectvalue.selectedIndex ].value ;\r\n");
      out.write("\tvar chosen;\r\n");
      out.write("\t//alert(id);\r\n");
      out.write("\tfor (h=0;h<500;h++){//get the size of the agent list\r\n");
      out.write("\t if (aIdArray[h]==id){\r\n");
      out.write("\t  chosen = h;\r\n");
      out.write("\t//alert(chosen);\r\n");
      out.write("\t  break;\r\n");
      out.write("\t }\r\n");
      out.write("\t}\r\n");
      out.write("\tif (w>=1){\r\n");
      out.write("\t  document.getElementById(\"agent_shifts1\").removeChild(document.getElementById('t'));\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\tlyr=document.createElement(\"DIV\");\r\n");
      out.write(" \tlyr.id ='t';\r\n");
      out.write("\r\n");
      out.write("\tvar code='';\r\n");
      out.write("\tcode =\"<table border='1'><tr><td>");
      out.print( pagePubHoData.getWord("Sunday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Monday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Tuesday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Wednesday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Thursday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Friday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Saturday"));
      out.write("</td></tr>\";\n");
      out.write("\tcode+=\"<tr><td align='left' bgcolor='#e6eff4'>\"+aSunArray[chosen]+\"</td><td bgcolor='#b4cfff'>\"+aMonArray[chosen]+\"</td><td bgcolor='#e6eff4'>\"+aTueArray[chosen]+\"</td>\";\r\n");
      out.write("\tcode+=\"<td align='left' bgcolor='#b4cfff'>\"+aWedArray[chosen]+\"</td><td bgcolor='#e6eff4'>\"+aThuArray[chosen]+\"</td><td bgcolor='#b4cfff'>\"+aFriArray[chosen]+\"</td>\";\r\n");
      out.write("\tcode+=\"<td bgcolor='#e6eff4'>\"+aSatArray[chosen]+\"</td></tr></table>\";\r\n");
      out.write("\r\n");
      out.write("   \tlyr.innerHTML = code;\r\n");
      out.write("  \tdocument.getElementById(\"agent_shifts1\").appendChild(lyr);\r\n");
      out.write("\tw++;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function bla2(selectvalue)\r\n");
      out.write("{\r\n");
      out.write("\tvar id = selectvalue.options[ selectvalue.selectedIndex ].value ;\r\n");
      out.write("\tvar chosen;\r\n");
      out.write("\tfor (h=0;h<500;h++){//get the size of the agent list\r\n");
      out.write("\t if (aIdArray[h]==id){\r\n");
      out.write("\t  chosen = h;\r\n");
      out.write("\t  break;\r\n");
      out.write("\t }\r\n");
      out.write("\t}\r\n");
      out.write("\tif (y>=1){\r\n");
      out.write("\t  document.getElementById(\"agent_shifts2\").removeChild(document.getElementById('r'));\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\tlyr=document.createElement(\"DIV\");\r\n");
      out.write(" \tlyr.id ='r';\r\n");
      out.write("\r\n");
      out.write("\tvar code='';\r\n");
      out.write("\tcode =\"<table border='1'><tr><td>");
      out.print( pagePubHoData.getWord("Sunday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Monday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Tuesday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Wednesday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Thursday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Friday"));
      out.write("</td><td>");
      out.print( pagePubHoData.getWord("Saturday"));
      out.write("</td></tr>\";\n");
      out.write("\tcode+=\"<tr><td align='left' bgcolor='#e6eff4'>\"+aSunArray[chosen]+\"</td><td bgcolor='#b4cfff'>\"+aMonArray[chosen]+\"</td><td bgcolor='#e6eff4'>\"+aTueArray[chosen]+\"</td>\";\r\n");
      out.write("\tcode+=\"<td align='left' bgcolor='#b4cfff'>\"+aWedArray[chosen]+\"</td><td bgcolor='#e6eff4'>\"+aThuArray[chosen]+\"</td><td bgcolor='#b4cfff'>\"+aFriArray[chosen]+\"</td>\";\r\n");
      out.write("\tcode+=\"<td bgcolor='#e6eff4'>\"+aSatArray[chosen]+\"</td></tr></table>\";\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("   \tlyr.innerHTML = code;\r\n");
      out.write("  \tdocument.getElementById(\"agent_shifts2\").appendChild(lyr);\r\n");
      out.write("    y++;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function addBreak()\r\n");
      out.write("{\r\n");
      out.write("    lyr=document.createElement(\"DIV\");\r\n");
      out.write(" \tlyr.id ='break'+nrows;\r\n");
      out.write("\tvar nom = 'start'+ nrows;\r\n");
      out.write("    var end_nom = 'end'+ nrows;\r\n");
      out.write("\tvar  code='';\r\n");
      out.write("    if (maxrow == 1)\r\n");
      out.write("\t{\r\n");
      out.write("    \tcode =\"<table><tr><td align='left'>");
      out.print( pagePubHoData.getWord("Start"));
      out.write("</td><td align='left'>");
      out.print( pagePubHoData.getWord("End"));
      out.write("</td><td>&nbsp;</td></tr>\";\n");
      out.write("        code += \"<tr><td align='left'><select id= '\"+nom+\"' name= '\"+nom+\"' >\";\r\n");
      out.write("\t}\r\n");
      out.write("\telse{\r\n");
      out.write("    \tcode =\"<table><tr><td align='left'><select id= '\"+nom+\"' name= '\"+nom+\"' >\";\r\n");
      out.write("\t}\r\n");
      out.write("    for (i = 1; i <= 23; i++)\r\n");
      out.write("\t{\r\n");
      out.write("\t\t code +=\" <option value='\"+i+\":00'>\"+i+\":00 </option>\";\r\n");
      out.write("                 code +=\" <option value='\"+i+\":15'>\"+i+\":15 </option>\";\r\n");
      out.write("                 code +=\" <option value='\"+i+\":30'>\"+i+\":30 </option>\";\r\n");
      out.write("                 code +=\" <option value='\"+i+\":45'>\"+i+\":45 </option>\";\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\tcode +=\"</select></td><td align='left'><select id= '\"+end_nom+\"' name= '\"+end_nom+\"' >\";\r\n");
      out.write("    for (i = 1; i <= 23; i++)\r\n");
      out.write("\t{\r\n");
      out.write("\t\t code +=\" <option value='\"+i+\":00'>\"+i+\":00 </option>\";\r\n");
      out.write("                 code +=\" <option value='\"+i+\":15'>\"+i+\":15 </option>\";\r\n");
      out.write("                 code +=\" <option value='\"+i+\":30'>\"+i+\":30 </option>\";\r\n");
      out.write("                 code +=\" <option value='\"+i+\":45'>\"+i+\":45 </option>\";\r\n");
      out.write("\t}\r\n");
      out.write("\tcode +=\" <option value='00:00'>00:45 </option>\";\r\n");
      out.write("\tcode +=\"</select></td>\";\r\n");
      out.write("\tcode +=\"<td align='left'>&nbsp;<a href='javascript:deleteMyRow(\"+nrows+\");'>delete</a></td></tr>\";\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("   \tlyr.innerHTML = code;\r\n");
      out.write("  \tdocument.getElementById(\"breaks\").appendChild(lyr);\r\n");
      out.write("\tnrows++;\r\n");
      out.write("    maxrow++;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function deleteMyRow(f)\r\n");
      out.write("{\r\n");
      out.write("  var xxx = 'break'+f;\r\n");
      out.write("  //var id = 'n'+f;\r\n");
      out.write("  //var value = document.getElementById(id).value;\r\n");
      out.write("  document.getElementById(\"breaks\").removeChild(document.getElementById(xxx));\r\n");
      out.write("  nrows--;\r\n");
      out.write("\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function setAbsent()\r\n");
      out.write("{\r\n");
      out.write("\tvar param='';\r\n");
      out.write("\tvar ab_sunday='',ab_monday='',ab_tuesday='',ab_wednesday='',ab_thursday='',ab_friday='',ab_saturday='';\r\n");
      out.write("\t if (document.getElementById('ab_sunday').checked){\r\n");
      out.write("\t\t\t  ab_sunday=document.getElementById('ab_sunday').value;\r\n");
      out.write("\t  }\r\n");
      out.write("\t if (document.getElementById('ab_monday').checked){\r\n");
      out.write("\t\t\t  ab_monday=document.getElementById('ab_monday').value;\r\n");
      out.write("\t  }\r\n");
      out.write("\t if (document.getElementById('ab_tuesday').checked){\r\n");
      out.write("\t\t\t  ab_tuesday=document.getElementById('ab_tuesday').value;\r\n");
      out.write("\t  }\r\n");
      out.write("\t if (document.getElementById('ab_wednesday').checked){\r\n");
      out.write("\t\t\t  ab_wednesday=document.getElementById('ab_wednesday').value;\r\n");
      out.write("\t  }\r\n");
      out.write("\t if (document.getElementById('ab_thursday').checked){\r\n");
      out.write("\t\t\t  ab_thursday=document.getElementById('ab_thursday').value;\r\n");
      out.write("\t  }\r\n");
      out.write("\t if (document.getElementById('ab_friday').checked){\r\n");
      out.write("\t\t\t  ab_friday=document.getElementById('ab_friday').value;\r\n");
      out.write("\t  }\r\n");
      out.write("\t if (document.getElementById('ab_saturday').checked){\r\n");
      out.write("\t\t\t  ab_saturday=document.getElementById('ab_saturday').value;\r\n");
      out.write("\t  }\r\n");
      out.write("\r\n");
      out.write("\t  document.published.action = '/aheevaccs/servlet/AbServlet?fct=absent&ab_sunday='+ab_sunday+'&ab_monday='+ab_monday+'&ab_tuesday='+ab_tuesday +'&ab_wednesday='+ab_wednesday+'&ab_thursday='+ab_thursday+'&ab_friday='+ab_friday+'&ab_saturday='+ab_saturday+'&lang='+lang+'&sel=1';\r\n");
      out.write("\t  return true;\r\n");
      out.write("}\r\n");
      out.write("function trade(){\r\n");
      out.write("\r\n");
      out.write("  document.published.action = '/aheevaccs/servlet/AbServlet?fct=trade&lang='+lang+'&sel=2' ;\r\n");
      out.write("\r\n");
      out.write("  return true;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function setQuit(){\r\n");
      out.write("//alert(curSelectedAgt);\r\n");
      out.write("document.published.action = '/aheevaccs/servlet/AbServlet?fct=quit&lang='+lang+'&agent='+curSelectedAgt+'&sel=2';\r\n");
      out.write("document.published.submit();\r\n");
      out.write("return true;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("var curSelectedAgt = '';\r\n");
      out.write("var curSelectAgtName = '';\r\n");
      out.write("var curSelectAgtDetails = '';\r\n");
      out.write("function setAgent(aName,afirstName,aID, aDetails){\r\n");
      out.write("    //document.getElementById('day').innerHTML = aName;\r\n");
      out.write("\tcurSelectedAgt = aID;\r\n");
      out.write("\tcurSelectAgtName = aName+','+afirstName;\r\n");
      out.write("\tcurSelectAgtDetails = aDetails;\r\n");
      out.write("\t//curSelectAgtDetails = 'OutSource 1990- Outsource 1992/OutSource 5000- Outsource 5500/OutSource 6000- Outsource 7000';\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function setAgentDetails(){\r\n");
      out.write(" \t//alert(curSelectAgtName+'...'+curSelectedAgt+'..'+curSelectAgtDetails)\r\n");
      out.write("\tvar detailshtml = '';\r\n");
      out.write("\tvar curSelectAgtDetailsArray = curSelectAgtDetails.split('/');\r\n");
      out.write("\tif(curSelectAgtDetailsArray.length > 0)\r\n");
      out.write("\t{\r\n");
      out.write("\t\tfor (var m=0; m < curSelectAgtDetailsArray.length; m++)\r\n");
      out.write("\t\t   detailshtml += curSelectAgtDetailsArray[m]+'<br>';\r\n");
      out.write("\t}\r\n");
      out.write("\telse\r\n");
      out.write("\t\tdetailshtml = curSelectAgtDetails;\r\n");
      out.write("\r\n");
      out.write("\tdocument.getElementById('agtDetailsInfo').innerHTML = detailshtml;\t\t       \t\t\t   //document.getElementById('details_'+curSelectedAgt).value\r\n");
      out.write("\tdocument.getElementById('agtName').innerHTML = curSelectAgtName;\r\n");
      out.write("\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function saveSchedule(){\r\n");
      out.write("\t var nbr_breaks = nrows - 1 ;\r\n");
      out.write("\t document.published.action = '/aheevaccs/servlet/SaveScheduleServlet?nbr_breaks='+nbr_breaks+'&sel=3' ;\r\n");
      out.write("\t return true;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function showmenuie5(e){\r\n");
      out.write("\r\n");
      out.write("\t//Find out how close the mouse is to the corner of the window\r\n");
      out.write("\tvar rightedge=ie5? document.body.clientWidth-event.clientX : window.innerWidth-e.clientX\r\n");
      out.write("\tvar bottomedge=ie5? document.body.clientHeight-event.clientY : window.innerHeight-e.clientY\r\n");
      out.write("\r\n");
      out.write("\t//if the horizontal distance isn't enough to accomodate the width of the context menu\r\n");
      out.write("\tif (rightedge<menuobj.offsetWidth)\r\n");
      out.write("\t\t//move the horizontal position of the menu to the left by it's width\r\n");
      out.write("\t\tmenuobj.style.left=ie5? document.body.scrollLeft+event.clientX-menuobj.offsetWidth : window.pageXOffset+e.clientX-menuobj.offsetWidth\r\n");
      out.write("\telse\r\n");
      out.write("\t\t//position the horizontal position of the menu where the mouse was clicked\r\n");
      out.write("\t\tmenuobj.style.left=ie5? document.body.scrollLeft+event.clientX : window.pageXOffset+e.clientX\r\n");
      out.write("\r\n");
      out.write("\t//same concept with the vertical position\r\n");
      out.write("\tif (bottomedge<menuobj.offsetHeight)\r\n");
      out.write("\t\tmenuobj.style.top=ie5? document.body.scrollTop+event.clientY-menuobj.offsetHeight : window.pageYOffset+e.clientY-menuobj.offsetHeight\r\n");
      out.write("\telse\r\n");
      out.write("\t\tmenuobj.style.top=ie5? document.body.scrollTop+event.clientY : window.pageYOffset+e.clientY\r\n");
      out.write("\r\n");
      out.write("\tmenuobj.style.visibility=\"visible\"\r\n");
      out.write("\treturn false\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function hidemenuie5(e){\r\n");
      out.write("\tmenuobj.style.visibility=\"hidden\"\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function highlightie5(e){\r\n");
      out.write("\tvar firingobj=ie5? event.srcElement : e.target\r\n");
      out.write("\tif (firingobj.className==\"menuitems\"||ns6&&firingobj.parentNode.className==\"menuitems\"){\r\n");
      out.write("\t\tif (ns6&&firingobj.parentNode.className==\"menuitems\") firingobj=firingobj.parentNode //up one node\r\n");
      out.write("\t\tfiringobj.style.backgroundColor=\"highlight\"\r\n");
      out.write("\t\tfiringobj.style.color=\"white\"\r\n");
      out.write("\t\tif (display_url==1)\r\n");
      out.write("\t\t\twindow.status=event.srcElement.url\r\n");
      out.write("\t}\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function lowlightie5(e){\r\n");
      out.write("\tvar firingobj=ie5? event.srcElement : e.target\r\n");
      out.write("\tif (firingobj.className==\"menuitems\"||ns6&&firingobj.parentNode.className==\"menuitems\"){\r\n");
      out.write("\tif (ns6&&firingobj.parentNode.className==\"menuitems\") firingobj=firingobj.parentNode //up one node\r\n");
      out.write("\tfiringobj.style.backgroundColor=\"\"\r\n");
      out.write("\tfiringobj.style.color=\"black\"\r\n");
      out.write("\twindow.status=''\r\n");
      out.write("\t}\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function jumptoie5(e){\r\n");
      out.write("\tvar firingobj=ie5? event.srcElement : e.target\r\n");
      out.write("\tif (firingobj.className==\"menuitems\"||ns6&&firingobj.parentNode.className==\"menuitems\"){\r\n");
      out.write("\t\tif (ns6&&firingobj.parentNode.className==\"menuitems\") firingobj=firingobj.parentNode\r\n");
      out.write("\r\n");
      out.write("\t\t//will open a servlet that will do the job - delete or switch to another agent\r\n");
      out.write("\t\tif (firingobj.getAttribute(\"target\"))\r\n");
      out.write("\t\twindow.open(firingobj.getAttribute(\"url\"),firingobj.getAttribute(\"target\"))\r\n");
      out.write("\t\telse\r\n");
      out.write("\t\twindow.location=firingobj.getAttribute(\"url\")\r\n");
      out.write("\t}\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function cursorPos(pX,pY)\r\n");
      out.write("{\r\n");
      out.write("  this.x = pX;\r\n");
      out.write("  this.y = pY;\r\n");
      out.write("}\r\n");
      out.write("var theClick = new cursorPos(0,0);\r\n");
      out.write("function setMousePos()\r\n");
      out.write("{\r\n");
      out.write("\ttheClick.x =  window.event.clientX;\r\n");
      out.write("\ttheClick.y =  window.event.clientY;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("var agtmenuObj;\r\n");
      out.write("function showAgtMenu()\r\n");
      out.write("{\r\n");
      out.write("\tsetAgentDetails()\r\n");
      out.write("\tsetMousePos();\r\n");
      out.write("\tagtmenuObj.style.top        = theClick.y + document.body.scrollTop;\r\n");
      out.write(" \tagtmenuObj.style.left       = theClick.x + document.body.scrollLeft ;\r\n");
      out.write("\twindow.status = (theClick.y+'..'+theClick.x+'.t.'+agtmenuObj.style.top+'.l.'+agtmenuObj.style.left + '.h.'+agtmenuObj.style.maxHeight + '.w..'+ agtmenuObj.style.maxWidth  )\r\n");
      out.write("\r\n");
      out.write("\tagtmenuObj.style.visibility = 'visible';\r\n");
      out.write(" \tdocument.getElementById('schedmenuAgtInfo').style.left = parseInt(agtmenuObj.style.left.substring(0,agtmenuObj.style.left.length-2),10) ;\r\n");
      out.write("\tdocument.getElementById('schedmenuAgtInfo').style.top = 20+ parseInt(agtmenuObj.style.top.substring(0,agtmenuObj.style.top.length-2),10) ;\r\n");
      out.write("\r\n");
      out.write(" \tdocument.getElementById('schedmenuAgtInfoItem1').style.left = 150 + parseInt(agtmenuObj.style.left.substring(0,agtmenuObj.style.left.length-2),10) ;\r\n");
      out.write("\tdocument.getElementById('schedmenuAgtInfoItem1').style.top = 20 + parseInt(agtmenuObj.style.top.substring(0,agtmenuObj.style.top.length-2),10) ;\r\n");
      out.write("\r\n");
      out.write(" \t/*document.getElementById('menuitems3').style.left = 120 + parseInt(schedmenuObj.style.left.substring(0,schedmenuObj.style.left.length-2),10) ;\r\n");
      out.write("\tdocument.getElementById('menuitems3').style.top = 42 + parseInt(schedmenuObj.style.top.substring(0,schedmenuObj.style.top.length-2),10) ;  */\r\n");
      out.write("        document.getElementById('schedmenuAgtQuit').style.left =  parseInt(agtmenuObj.style.left.substring(0,agtmenuObj.style.left.length-2),10) ;\r\n");
      out.write("\tdocument.getElementById('schedmenuAgtQuit').style.top = 40 + parseInt(agtmenuObj.style.top.substring(0,agtmenuObj.style.top.length-2),10) ;\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\treturn false;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function showAgtMenuItems()\r\n");
      out.write("{\r\n");
      out.write("  \t//document.getElementById('agtDetailsInfo').innerHTML = 'bertrand';\r\n");
      out.write("  \tdocument.getElementById('schedmenuAgtInfo').style.visibility = 'visible';\r\n");
      out.write(" \tdocument.getElementById('schedmenuAgtInfoItem1').style.visibility = 'hidden';\r\n");
      out.write(" \t//document.getElementById('menuitems3').style.visibility = 'visible';\r\n");
      out.write(" \tdocument.getElementById('schedmenuAgtQuit').style.visibility = 'visible';\r\n");
      out.write("}\r\n");
      out.write("function showAgtMenuItems1()\r\n");
      out.write("{\r\n");
      out.write(" \tdocument.getElementById('schedmenuAgtInfoItem1').style.visibility = 'visible';\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function hideAgtMenu()\r\n");
      out.write("{\r\n");
      out.write("\t document.getElementById('schedmenuAgtInfo').style.visibility = 'hidden';\r\n");
      out.write("\t document.getElementById('schedmenuAgtInfoItem1').style.visibility = 'hidden';\r\n");
      out.write("\t// document.getElementById('menuitems3').style.visibility = 'hidden';\r\n");
      out.write(" \tdocument.getElementById('schedmenuAgtQuit').style.visibility = 'hidden';\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write(" \t agtmenuObj.style.visibility = 'hidden';\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function hideAgtMenuItems()\r\n");
      out.write("{\r\n");
      out.write("\tsetMousePos();\r\n");
      out.write("\tvar smenuitemObj = document.getElementById('schedmenuAgtInfo');\r\n");
      out.write("\tvar diffX =document.body.scrollLeft+theClick.x-parseInt(agtmenuObj.style.left.substring(0,agtmenuObj.style.left.length-2));\r\n");
      out.write("\tvar diffY =document.body.scrollTop + theClick.y-parseInt(agtmenuObj.style.top.substring(0,agtmenuObj.style.top.length-2));\r\n");
      out.write("\t//var maxwidth = parseInt(schedmenuObj.style.width.substring(0,schedmenuObj.style.width.length-2)) + parseInt(smenuitemObj.style.width.substring(0,smenuitemObj.style.width.length-2));\r\n");
      out.write("\t//diffX = diffX - 23;\r\n");
      out.write("\t//diffY = diffY - 28;\r\n");
      out.write("\tif((diffX < 0) || (diffX > 200) ||(diffY < 0) || (diffY > 50)){\r\n");
      out.write("            document.getElementById('schedmenuAgtInfo').style.visibility = 'hidden';\r\n");
      out.write("\t    document.getElementById('schedmenuAgt').style.visibility = 'hidden';\r\n");
      out.write("\t    document.getElementById('schedmenuAgtInfoItem1').style.visibility = 'hidden';\r\n");
      out.write("\t    document.getElementById('schedmenuAgtQuit').style.visibility = 'hidden';\r\n");
      out.write("\r\n");
      out.write(" \t }\r\n");
      out.write("\t//window.status = ('..x='+theClick.x+'..y='+theClick.y+ ' diffX='+diffX+'..diffY='+diffY)\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("if (ie5||ns6){\r\n");
      out.write("menuobj.style.display=''\r\n");
      out.write("//document.oncontextmenu=showmenuie5\r\n");
      out.write("document.onclick=hidemenuie5\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("</script>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      aheevaManager.wfm_schedule.beanSchedule sc = null;
      synchronized (request) {
        sc = (aheevaManager.wfm_schedule.beanSchedule) _jspx_page_context.getAttribute("sc", PageContext.REQUEST_SCOPE);
        if (sc == null){
          sc = new aheevaManager.wfm_schedule.beanSchedule();
          _jspx_page_context.setAttribute("sc", sc, PageContext.REQUEST_SCOPE);
        }
      }
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");

    String startingDateDaily = request.getParameter("startingDateDaily");
    String endingDateDaily   = request.getParameter("endingDateDaily");
    String startingDate="";
    String endingDate="";
    String sRet="";
    int i,j,k;
    long tLoginTime;
    String agents = "",myagt="";
    String [] m_Agents;
    String [] m_tLoginTime;

    String agentGroups  = request.getParameter("group");
    StringTokenizer tok = null, tokGrp=null,  tokn = null;
    String agentGroupName ="";
    String agentGroup ="";
    String   aPeriod="";
    if(agentGroups != null){
        tok = new java.util.StringTokenizer(agentGroups,"/");
    }else{
        tok = new java.util.StringTokenizer("","/");
    }

    int numCampaigns = tok.countTokens();
    for( k = 0; k <numCampaigns; k++ ) {
        String agentGroupTemp = tok.nextToken();
        tokGrp = new java.util.StringTokenizer(agentGroupTemp,",");
        agentGroupName =tokGrp.nextToken();
        agentGroup = tokGrp.nextToken();
    }


      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<form name=\"published\"  method=\"post\" >\r\n");
      out.write("<div class=\"img-control\" >\r\n");
      out.write("<table align=\"right\" border=\"0\" width=\"25%\">\r\n");
      out.write("\r\n");
      out.write("</table>\r\n");
      out.write("</div>\r\n");
      out.write("<div class=\"tab-pane\" id=\"tabPane1\" >\r\n");
      out.write("\t <script type=\"text/javascript\">\r\n");
      out.write("\t  tp1 = new WebFXTabPane( document.getElementById( \"tabPane1\" ) );\r\n");
      out.write("\t </script>\r\n");
      out.write("\r\n");
      out.write("\t<div class=\"tab-page\" id=\"tabPage1\"  align=\"center\">\r\n");
      out.write("\t  <h2 class=\"tab\">");
      out.print( pagePubHoData.getWord("Schedule"));
      out.write("</h2>\n");
      out.write("\t   <script type=\"text/javascript\">tp1.addTabPage( document.getElementById( \"tabPage1\" ) );\r\n");
      out.write("\t   </script>\r\n");
      out.write("\t  <fieldset >\r\n");
      out.write("\t\t<table width=\"600\"  border=\"0\">\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td>&nbsp;</td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td width=\"550\" class=\"reportsID\"><div align=\"center\"><b>\r\n");
      out.write("\t\t\t\t");
      out.print( pagePubHoData.getWord("Schedule"));
      out.write("&nbsp; ");
      out.print( pagePubHoData.getWord("From"));
      out.write(":\n");
      out.write("\t\t\t\t");
out.write(startingDateDaily);	
      out.write("\r\n");
      out.write("\t\t\t\tto\r\n");
      out.write("\t\t\t\t");
out.write(endingDateDaily);	
      out.write("\r\n");
      out.write("\t\t\t\t</b></div></td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td>&nbsp;</td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td width=\"550\" class=\"reportsID\"><div align=\"center\"><b>\r\n");
      out.write("\t\t\t\t\t");
      out.print( pagePubHoData.getWord("Agent group"));
      out.write(':');
      out.write(' ');
      out.write(' ');
out.write(agentGroupName);
      out.write("   </b></div>\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td>&nbsp;</td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t</table>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t<span class=clickableSpan  id=\"spanObj\"   onclick= \"hideAgtMenu()\" onMouseMove=\"hideAgtMenuItems()\">\n");
      out.write("\t\t<!--//oncontextmenu=\"showAgtMenu(); return false\"<span class=clickableSpan style=\"position:absolute\" oncontextmenu=\"showmenuie5(); return false\" oncontextmenu = \"showAgtMenu(); return false\" onclick= \"hideAgtMenu()\" onMouseMove=\"hideAgtMenuItems()\">-->\n");
      out.write("\r\n");
      out.write("\t\t<table>\r\n");
      out.write("\t\t  <tr bgcolor='#e6eff4'>\r\n");
      out.write("<td>");
      out.print( pagePubHoData.getWord("Name"));
      out.write("  </td>\n");
      out.write("<td>");
      out.print( pagePubHoData.getWord("Sunday"));
      out.write(" </td>\n");
      out.write("<td>");
      out.print( pagePubHoData.getWord("Monday"));
      out.write(" </td>\n");
      out.write("<td>");
      out.print( pagePubHoData.getWord("Tuesday"));
      out.write(" </td>\n");
      out.write("<td>");
      out.print( pagePubHoData.getWord("Wednesday"));
      out.write(" </td>\n");
      out.write("<td>");
      out.print( pagePubHoData.getWord("Thursday"));
      out.write(" </td>\n");
      out.write("<td>");
      out.print( pagePubHoData.getWord("Friday"));
      out.write(" </td>\n");
      out.write("<td>");
      out.print( pagePubHoData.getWord("Saturday"));
      out.write(" </td>\n");
      out.write("<td>");
      out.print( pagePubHoData.getWord("Total hours"));
      out.write(" </td>\n");
      out.write("\r\n");
      out.write("\t\t  </tr>\r\n");
      out.write("\t\t  ");

		   //get the connection
		   try{
                        sc.getConnection();
       			sc.GetGroupAgentPublishedSchedule(startingDateDaily,endingDateDaily, agentGroup);
		   }catch(Exception e){
		   }
		   for (i = 0; i < sc.m_vAllAgents.size(); i++) {
			  beanAgentLoginInfo agent = (beanAgentLoginInfo)sc.m_vAllAgents.elementAt(i); 
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t\t");
if (i%2==0){
      out.write("\r\n");
      out.write("\t\t\t<tr bgcolor='#b4cfff'>\r\n");
      out.write("\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t<tr bgcolor='#e6eff4'>\r\n");
      out.write("\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t<td> ");
out.write(agent.last_name);
      out.write(',');
out.write(agent.first_name);
      out.write("&nbsp;\r\n");
      out.write("\t\t\t\t \t[");
out.write(agent.agt_login_id);
      out.write("] </td>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t<script language=\"JavaScript\">\r\n");
      out.write("\t\t\t\taIdArray[");
      out.print( i );
      out.write("] = '");
      out.print( agent.agt_id);
      out.write("';\r\n");
      out.write("\t\t\t\t</script>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t");
if (agent.shifts.sunstat.startsWith("1")){
      out.write("\r\n");
      out.write("\t\t\t\t     <td bgcolor='red' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[0]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}else if(agent.shifts.sunstat.startsWith("2")){
      out.write("\r\n");
      out.write("                                    <td bgcolor='yellow' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[0]);
      out.write("')\">\r\n");
      out.write("                                ");
}else{
      out.write("\r\n");
      out.write("\t\t\t\t     <td onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[0]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t");
 if(agent.shifts.sun.length()>=1){
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t");
 if (agent.shifts.sun.length()>0) {
      out.write("\r\n");
      out.write("\t\t\t\t  ");
 out.write(agent.shifts.sun.substring(0,5)+ "-" + agent.shifts.sun.substring(agent.shifts.sun.length()-5,agent.shifts.sun.length()) );  
      out.write("\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\t&nbsp;\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t    </td>\r\n");
      out.write("\t\t\t\t<script language=\"JavaScript\">\r\n");
      out.write("\t\t\t\t");
 if(agent.shifts.sun.length()>=1){
      out.write("\r\n");
      out.write("\t\t\t\taSunArray[");
      out.print( i );
      out.write("] = '");
      out.print( agent.shifts.sun.toString() );
      out.write("'+'-'+");
      out.print(agent.shifts.sunstat.toString() );
      out.write(";\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\taSunArray[");
      out.print( i );
      out.write("] = '';\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t</script>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t");
if (agent.shifts.monstat.startsWith("1")){
      out.write("\r\n");
      out.write("\t\t\t\t     <td bgcolor='red' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[1]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}else if(agent.shifts.monstat.startsWith("2")){
      out.write("\r\n");
      out.write("\t\t\t\t    <td bgcolor='yellow' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[1]);
      out.write("')\">\r\n");
      out.write("                                ");
}else{
      out.write("\r\n");
      out.write("\t\t\t\t     <td onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[1]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t");
 if (agent.shifts.mon.length()>0) {
      out.write("\r\n");
      out.write("\t\t\t\t");
 out.write(agent.shifts.mon.substring(0,5)+ "-" + agent.shifts.mon.substring(agent.shifts.mon.length()-5,agent.shifts.mon.length()) );  
      out.write("\r\n");
      out.write("\t\t\t\t");
}
      out.write("</td>\r\n");
      out.write("\t\t\t\t<script language=\"JavaScript\">\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t");
 if(agent.shifts.mon.length()>=1){
      out.write("\r\n");
      out.write("\t\t\t\taMonArray[");
      out.print( i );
      out.write("] = '");
      out.print( agent.shifts.mon.toString() );
      out.write("'+'-'+");
      out.print(agent.shifts.monstat.toString() );
      out.write(";\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\taMonArray[");
      out.print( i );
      out.write("] = '';\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t</script>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t");
if (agent.shifts.tuesstat.startsWith("1")){
      out.write("\r\n");
      out.write("\t\t\t\t      <td bgcolor='red' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[2]);
      out.write("')\">\r\n");
      out.write("                                ");
}else if (agent.shifts.tuesstat.startsWith("2")){
      out.write("\r\n");
      out.write("\t\t\t\t      <td bgcolor='yellow' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[2]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\t     <td onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[2]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t");
if (agent.shifts.tues.length()>0){
      out.write("\r\n");
      out.write("\t\t\t\t     ");
 out.write(agent.shifts.tues.substring(0,5)+ "-" + agent.shifts.tues.substring(agent.shifts.tues.length()-5,agent.shifts.tues.length()) );  
      out.write("\r\n");
      out.write("\t\t\t\t");
}
      out.write(" </td>\r\n");
      out.write("\t\t\t\t<script language=\"JavaScript\">\r\n");
      out.write("\t\t\t\t");
 if(agent.shifts.tues.length()>=1){
      out.write("\r\n");
      out.write("\t\t\t\taTueArray[");
      out.print( i );
      out.write("] = '");
      out.print( agent.shifts.tues.toString() );
      out.write("'+'-'+");
      out.print(agent.shifts.tuesstat.toString() );
      out.write(";\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\taTueArray[");
      out.print( i );
      out.write("] = '';\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t</script>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t");
if (agent.shifts.wednesstat.startsWith("1")){
      out.write("\r\n");
      out.write("\t\t\t\t      <td bgcolor='red' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[3]);
      out.write("')\">\r\n");
      out.write("                               ");
}else if (agent.shifts.wednesstat.startsWith("2")){
      out.write("\r\n");
      out.write("\t\t\t\t      <td bgcolor='yellow' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[3]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\t     <td onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[3]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t");
if (agent.shifts.wednes.length()>0){
      out.write("\r\n");
      out.write("\t\t\t\t     ");
 out.write(agent.shifts.wednes.substring(0,5)+ "-" + agent.shifts.wednes.substring(agent.shifts.wednes.length()-5,agent.shifts.wednes.length()) );  
      out.write("\r\n");
      out.write("\t\t\t\t");
}
      out.write("</td>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t<script language=\"JavaScript\">\r\n");
      out.write("\t\t\t\t");
 if(agent.shifts.wednes.length()>=1){
      out.write("\r\n");
      out.write("\t\t\t\taWedArray[");
      out.print( i );
      out.write("] = '");
      out.print( agent.shifts.wednes.toString() );
      out.write("'+'-'+");
      out.print(agent.shifts.wednesstat.toString() );
      out.write(";\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\taWedArray[");
      out.print( i );
      out.write("] = '';\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t</script>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t");
if (agent.shifts.thursstat.startsWith("1")){
      out.write("\r\n");
      out.write("\t\t\t\t      <td bgcolor='red' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[4]);
      out.write("')\">\r\n");
      out.write("                                ");
}else if (agent.shifts.thursstat.startsWith("2")){
      out.write("\r\n");
      out.write("\t\t\t\t      <td bgcolor='yellow' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[4]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\t     <td onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[4]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t");
if (agent.shifts.thurs.length()>0){
      out.write("\r\n");
      out.write("\t\t\t\t     ");
 out.write(agent.shifts.thurs.substring(0,5)+ "-" + agent.shifts.thurs.substring(agent.shifts.thurs.length()-5,agent.shifts.thurs.length()) );  
      out.write("\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t<script language=\"JavaScript\">\r\n");
      out.write("\t\t\t\t");
 if(agent.shifts.thurs.length()>=1){
      out.write("\r\n");
      out.write("\t\t\t\taThuArray[");
      out.print( i );
      out.write("] = '");
      out.print( agent.shifts.thurs.toString() );
      out.write("'+'-'+");
      out.print(agent.shifts.thursstat.toString() );
      out.write(";\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\taThuArray[");
      out.print( i );
      out.write("] = '';\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t</script>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t ");
if (agent.shifts.fristat.startsWith("1")){
      out.write("\r\n");
      out.write("\t\t\t\t\t  <td bgcolor='red' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[5]);
      out.write("')\">\r\n");
      out.write("                                 ");
}else if (agent.shifts.fristat.startsWith("2")){
      out.write("\r\n");
      out.write("\t\t\t\t\t  <td bgcolor='yellow' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[5]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\t\t <td onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[5]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t");
if (agent.shifts.fri.length()>0){
      out.write("\r\n");
      out.write("\t\t\t\t     ");
 out.write(agent.shifts.fri.substring(0,5)+ "-" + agent.shifts.fri.substring(agent.shifts.fri.length()-5,agent.shifts.fri.length()) );  
      out.write("\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t<script language=\"JavaScript\">\r\n");
      out.write("\t\t\t\t");
 if(agent.shifts.fri.length()>=1){
      out.write("\r\n");
      out.write("\t\t\t\taFriArray[");
      out.print( i );
      out.write("] = '");
      out.print( agent.shifts.fri.toString() );
      out.write("'+'-'+");
      out.print(agent.shifts.fristat.toString() );
      out.write(";\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\taFriArray[");
      out.print( i );
      out.write("] = '';\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t</script>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t");
if (agent.shifts.saturstat.startsWith("1")){
      out.write("\r\n");
      out.write("\t\t\t\t\t  <td bgcolor='red' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[6]);
      out.write("')\">\r\n");
      out.write("                                ");
}else if (agent.shifts.saturstat.startsWith("2")){
      out.write("\r\n");
      out.write("\t\t\t\t\t  <td bgcolor='yellow' onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[6]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\t\t <td onMouseover=\"setAgent('");
out.write(agent.last_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
out.write(agent.first_name);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.agt_id);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(agent.shifts.detailsPerDay[6]);
      out.write("')\">\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t");
if (agent.shifts.satur.length()>0){
      out.write("\r\n");
      out.write("\t\t\t\t     ");
 out.write(agent.shifts.satur.substring(0,5)+ "-" + agent.shifts.satur.substring(agent.shifts.satur.length()-5,agent.shifts.satur.length()) );  
      out.write("\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t<script language=\"JavaScript\">\r\n");
      out.write("\t\t\t\t");
 if(agent.shifts.satur.length()>=1){
      out.write("\r\n");
      out.write("\t\t\t\taSatArray[");
      out.print( i );
      out.write("] = '");
      out.print( agent.shifts.satur.toString() );
      out.write("'+'-'+");
      out.print(agent.shifts.saturstat.toString() );
      out.write(";\r\n");
      out.write("\t\t\t\t");
}else{
      out.write("\r\n");
      out.write("\t\t\t\taSatArray[");
      out.print( i );
      out.write("] = '';\r\n");
      out.write("\t\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t\t</script>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t<td>");
 out.write(agent.shifts.getTotal()); 
      out.write("</td>\r\n");
      out.write("\t\t\t </tr>\r\n");
      out.write("\r\n");
      out.write("\t\t ");
} // fin for
		 //get the connection
		   try{
			   sc.closeConnection();
		   }catch(Exception e){
		   }

		 
      out.write("\r\n");
      out.write("\t\t</table>\r\n");
      out.write("\r\n");
      out.write("\t\t<table>\r\n");
      out.write("\t\t\t <tr>\r\n");
      out.write("\t\t\t   <td  style=\"background-color:red\" width=\"40\"></td><td>&nbsp;</td><td>");
      out.print( pagePubHoData.getWord("agent absent this day"));
      out.write("  </td>\n");
      out.write("\t\t\t </tr>\r\n");
      out.write("                         <tr>\r\n");
      out.write("\t\t\t   <td  style=\"background-color:yellow\" width=\"40\"></td><td>&nbsp;</td><td>");
      out.print( pagePubHoData.getWord("agent has quit"));
      out.write("  </td>\n");
      out.write("\t\t\t </tr>\r\n");
      out.write("\t\t   </table>\r\n");
      out.write("\r\n");
      out.write("\t\t<script>\r\n");
      out.write("\t\tagtmenuObj = document.getElementById('schedmenuAgt');\r\n");
      out.write("\r\n");
      out.write("\t\t</script>\r\n");
      out.write("\t\t</span>\r\n");
      out.write("\r\n");
      out.write("\t </fieldset>\r\n");
      out.write("\t</div>\r\n");
      out.write("\r\n");
      out.write("\t<div class=\"tab-page\" id=\"tabPage2\"  align=\"center\">\r\n");
      out.write("\t  <h2 class=\"tab\">");
      out.print( pagePubHoData.getWord("Absence"));
      out.write(" </h2>\n");
      out.write("\t   <script type=\"text/javascript\">tp1.addTabPage( document.getElementById( \"tabPage2\" ) );\r\n");
      out.write("\t   </script>\r\n");
      out.write("\t  <fieldset>\r\n");
      out.write("      ");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");

////open connection to database///////
beanManagerData pagexc2Data = new beanManagerData();
System.out.println(session.getAttribute("USER_LANGUAGE"));
if( session.getAttribute("USER_LANGUAGE") != null )
	pagexc2Data.setDefaultLanguage((String)session.getAttribute("USER_LANGUAGE"));
pagexc2Data.openConnection();
    
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<script language=\"javascript\" type=\"text/javascript\">\r\n");
      out.write("// variables of labels;// \r\n");
      out.write("var phrase= new Array();\r\n");
      out.write("phrase[0]=\"");
      out.print( pagexc2Data.getWord("January"));
      out.write("\";\r\n");
      out.write("phrase[1]=\"");
      out.print( pagexc2Data.getWord("February"));
      out.write("\";\r\n");
      out.write("phrase[2]=\"");
      out.print( pagexc2Data.getWord("March"));
      out.write("\";\r\n");
      out.write("phrase[3]=\"");
      out.print( pagexc2Data.getWord("April"));
      out.write("\";\r\n");
      out.write("phrase[4]=\"");
      out.print( pagexc2Data.getWord("May"));
      out.write("\";         \r\n");
      out.write("phrase[5]=\"");
      out.print( pagexc2Data.getWord("June"));
      out.write("\";\r\n");
      out.write("phrase[6]=\"");
      out.print( pagexc2Data.getWord("July"));
      out.write("\";\r\n");
      out.write("phrase[7]=\"");
      out.print( pagexc2Data.getWord("August"));
      out.write("\";\r\n");
      out.write("phrase[8]=\"");
      out.print( pagexc2Data.getWord("September"));
      out.write("\";\r\n");
      out.write("phrase[9]=\"");
      out.print( pagexc2Data.getWord("October"));
      out.write("\";\r\n");
      out.write("phrase[10]=\"");
      out.print( pagexc2Data.getWord("November"));
      out.write("\";\r\n");
      out.write("phrase[11]=\"");
      out.print( pagexc2Data.getWord("December"));
      out.write("\";\r\n");
      out.write("phrase[12]=\"");
      out.print( pagexc2Data.getWord("Jan"));
      out.write("\";\r\n");
      out.write("phrase[13]=\"");
      out.print( pagexc2Data.getWord("Feb"));
      out.write("\";\r\n");
      out.write("phrase[14]=\"");
      out.print( pagexc2Data.getWord("Mar"));
      out.write("\";\r\n");
      out.write("phrase[15]=\"");
      out.print( pagexc2Data.getWord("Apr"));
      out.write("\";\r\n");
      out.write("phrase[16]=\"");
      out.print( pagexc2Data.getWord("May"));
      out.write("\";\r\n");
      out.write("phrase[17]=\"");
      out.print( pagexc2Data.getWord("Jun"));
      out.write("\";\r\n");
      out.write("phrase[18]=\"");
      out.print( pagexc2Data.getWord("Jul"));
      out.write("\";\r\n");
      out.write("phrase[19]=\"");
      out.print( pagexc2Data.getWord("Aug"));
      out.write("\";\r\n");
      out.write("phrase[20]=\"");
      out.print( pagexc2Data.getWord("Sep"));
      out.write("\";\r\n");
      out.write("phrase[21]=\"");
      out.print( pagexc2Data.getWord("Oct"));
      out.write("\";\r\n");
      out.write("phrase[22]=\"");
      out.print( pagexc2Data.getWord("Nov"));
      out.write("\";\r\n");
      out.write("phrase[23]=\"");
      out.print( pagexc2Data.getWord("Dec"));
      out.write("\";\r\n");
      out.write("phrase[24]=\"");
      out.print( pagexc2Data.getWord("Sunday"));
      out.write("\";\r\n");
      out.write("phrase[25]=\"");
      out.print( pagexc2Data.getWord("Monday"));
      out.write("\";\r\n");
      out.write("phrase[26]=\"");
      out.print( pagexc2Data.getWord("Tuesday"));
      out.write("\";\r\n");
      out.write("phrase[27]=\"");
      out.print( pagexc2Data.getWord("Wednesday"));
      out.write("\";\r\n");
      out.write("phrase[28]=\"");
      out.print( pagexc2Data.getWord("Thursday"));
      out.write("\";\r\n");
      out.write("phrase[29]=\"");
      out.print( pagexc2Data.getWord("Friday"));
      out.write("\";\r\n");
      out.write("phrase[30]=\"");
      out.print( pagexc2Data.getWord("Saturday"));
      out.write("\";\r\n");
      out.write("phrase[31]=\"");
      out.print( pagexc2Data.getWord("Sun"));
      out.write("\";\r\n");
      out.write("phrase[32]=\"");
      out.print( pagexc2Data.getWord("Mon"));
      out.write("\";\r\n");
      out.write("phrase[33]=\"");
      out.print( pagexc2Data.getWord("Tue"));
      out.write("\";\r\n");
      out.write("phrase[34]=\"");
      out.print( pagexc2Data.getWord("Wed"));
      out.write("\";\r\n");
      out.write("phrase[35]=\"");
      out.print( pagexc2Data.getWord("Thu"));
      out.write("\";\r\n");
      out.write("phrase[36]=\"");
      out.print( pagexc2Data.getWord("Fri"));
      out.write("\";\r\n");
      out.write("phrase[37]=\"");
      out.print( pagexc2Data.getWord("Sat"));
      out.write("\";\r\n");
      out.write("phrase[38]=\"");
      out.print( pagexc2Data.getWord("Su"));
      out.write("\";\r\n");
      out.write("phrase[39]=\"");
      out.print( pagexc2Data.getWord("Mo"));
      out.write("\";\r\n");
      out.write("phrase[40]=\"");
      out.print( pagexc2Data.getWord("Tu"));
      out.write("\";\r\n");
      out.write("phrase[41]=\"");
      out.print( pagexc2Data.getWord("We"));
      out.write("\";\r\n");
      out.write("phrase[42]=\"");
      out.print( pagexc2Data.getWord("Th"));
      out.write("\";\r\n");
      out.write("phrase[43]=\"");
      out.print( pagexc2Data.getWord("Fr"));
      out.write("\";\r\n");
      out.write("phrase[44]=\"");
      out.print( pagexc2Data.getWord("Sa"));
      out.write("\";\r\n");
      out.write("phrase[45]=\"");
      out.print( pagexc2Data.getWord(" Today "));
      out.write("\";\r\n");
      out.write("phrase[46]=\"");
      out.print( pagexc2Data.getWord("Clear"));
      out.write("\";\r\n");
      out.write("phrase[47]=\"");
      out.print( pagexc2Data.getWord("Back"));
      out.write("\";\r\n");
      out.write("phrase[48]=\"");
      out.print( pagexc2Data.getWord("Close"));
      out.write("\";\r\n");
      out.write("phrase[49]=\"");
      out.print( pagexc2Data.getWord("Reset"));
      out.write("\";\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("</script>\r\n");
 pagexc2Data.closeConnection(); 
      out.write("\n");
      out.write("\t\t<!-- Calendrier dbut -->\r\n");
      out.write("\t\t<script language=\"javascript\" src=\"../Resources_pages/xc2_default.js\"></script>\r\n");
      out.write("\t\t<script language=\"javascript\">xcAutoHide=1000;</script>\r\n");
      out.write("\t\t<script language=\"javascript\" src=\"../Resources_pages/xc2_inpage.js\"></script>\r\n");
      out.write("\t\t<!-- Calendrier fin -->\r\n");
      out.write("\r\n");
      out.write("\t\t<table width=\"600\"  border=\"0\">\r\n");
      out.write("  <tr>\r\n");
      out.write("   <td>&nbsp;</td>\r\n");
      out.write("  </tr>\r\n");
      out.write(" <tr>\r\n");
      out.write("    <td width=\"550\" class=\"reportsID\">\r\n");
      out.write("     <div align=\"center\">\r\n");
      out.write("       <b>");
      out.print( pagePubHoData.getWord("Absence management for group"));
      out.write(" <br>");
out.write(agentGroupName);
      out.write("<br>\n");
      out.write("   ");
      out.print( pagePubHoData.getWord("From"));
      out.write(' ');
      out.write(' ');
out.write(startingDateDaily);
      out.print( pagePubHoData.getWord("To"));
      out.write(' ');
      out.write(' ');
out.write(endingDateDaily);
      out.write("</b>\n");
      out.write("     </div>\r\n");
      out.write("    </td>\r\n");
      out.write("  </tr>\r\n");
      out.write("  <tr>\r\n");
      out.write("   <td>&nbsp;</td>\r\n");
      out.write("  </tr>\r\n");
      out.write("  <tr>\r\n");
      out.write("   <td>&nbsp;</td>\r\n");
      out.write("  </tr>\r\n");
      out.write("</table>\r\n");
      out.write("\t\t<input type=\"hidden\" name=\"start_date\" value='");
out.write(startingDateDaily);
      out.write("'>\r\n");
      out.write("\t\t<input type=\"hidden\" name=\"end_date\" value='");
out.write(endingDateDaily);
      out.write("'>\r\n");
      out.write("\t\t<input type=\"hidden\" name=\"group\" value='");
out.write(agentGroup);
      out.write("'>\r\n");
      out.write("\t\t<input type=\"hidden\" name=\"groupName\" value='");
out.write(agentGroupName);
      out.write("'>\r\n");
      out.write("\r\n");
      out.write("\t\t<table border=0 align=\"left\">\r\n");
      out.write("\t\t   <tr>\r\n");
      out.write("\t\t\t<td align=\"left\">");
      out.print( pagePubHoData.getWord("Choose agent"));
      out.write(" </td>\n");
      out.write("\t\t\t<td align=\"left\">\r\n");
      out.write("\t\t\t<SELECT NAME=\"agent\" onChange=\"change(this)\">\r\n");
      out.write("\t\t\t<option>\r\n");
      out.write("\t\t\t");
 for (i = 0; i < sc.m_vAllAgents.size(); i++) {
			beanAgentLoginInfo agent = (beanAgentLoginInfo)sc.m_vAllAgents.elementAt(i); 
      out.write("\r\n");
      out.write("\t\t\t<OPTION VALUE=\"");
out.write(agent.agt_id);
      out.write('"');
      out.write('>');
out.write(agent.last_name);
      out.write(',');
out.write(agent.first_name);
      out.write("\r\n");
      out.write("\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t</SELECT>\r\n");
      out.write("\t\t\t</td>\r\n");
      out.write("\t\t\t<td>&nbsp;</td>\r\n");
      out.write("\t\t   </tr>\r\n");
      out.write("\t\t   <tr>\r\n");
      out.write("\t\t\t<td>&nbsp;</td><td>&nbsp;</td>\r\n");
      out.write("\t\t   </tr>\r\n");
      out.write("\t\t<!-- mettre en commentaire-->\r\n");
      out.write("\r\n");
      out.write("\t\t<!--Fin commentaire -->\r\n");
      out.write("\t\t   <tr>\r\n");
      out.write("\t\t\t<td align=\"left\">");
      out.print( pagePubHoData.getWord("Schedule"));
      out.write(" </td>\n");
      out.write("\t\t\t<td align=\"left\">\r\n");
      out.write("\t\t\t <div id=\"agent_shift\" style=\"MARGIN: 0px 5px\">\r\n");
      out.write("\t\t\t </div>\r\n");
      out.write("\t\t\t</td>\r\n");
      out.write("\r\n");
      out.write("\t\t   </tr>\r\n");
      out.write("\t\t   <tr>\r\n");
      out.write("\t\t\t<td>&nbsp;</td><td>&nbsp;</td>\r\n");
      out.write("\t\t   </tr>\r\n");
      out.write("\t\t   <tr>\r\n");
      out.write("\t\t\t<td align=\"left\">\r\n");
      out.write("\t\t\t<input name=\"submitButton\" type=\"submit\" value=\"");
      out.print( pagePubHoData.getWord("Save"));
      out.write("\" onClick=\"return setAbsent();\"/>\n");
      out.write("\t\t\t<td>&nbsp;</td>\r\n");
      out.write("\t\t   </tr>\r\n");
      out.write("\t\t  </table>\r\n");
      out.write("\t  </fieldset>\r\n");
      out.write("\t</div>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t<div class=\"tab-page\" id=\"tabPage3\"  align=\"center\">\r\n");
      out.write("\t  <h2 class=\"tab\">");
      out.print( pagePubHoData.getWord("Shift trade"));
      out.write(" </h2>\n");
      out.write("\t   <script type=\"text/javascript\">tp1.addTabPage( document.getElementById( \"tabPage3\" ) ); </script>\r\n");
      out.write("\t  \t<fieldset>\r\n");
      out.write("\r\n");
      out.write("\t  \t<table width=\"600\"  border=\"0\">\r\n");
      out.write("\t\t  <tr>\r\n");
      out.write("\t\t   <td>&nbsp;</td>\r\n");
      out.write("\t\t  </tr>\r\n");
      out.write("\t\t <tr>\r\n");
      out.write("\t\t\t<td width=\"550\" class=\"reportsID\"><div align=\"center\">\r\n");
      out.write("\t\t\t\t<b>\r\n");
      out.write("\t\t\t\t");
      out.print( pagePubHoData.getWord("Shift trade management for group"));
      out.write(" <br>");
out.write(agentGroupName);
      out.write("\n");
      out.write("\t\t\t\t</b></div>\r\n");
      out.write("\t\t\t</td>\r\n");
      out.write("\t\t  </tr>\r\n");
      out.write("\t\t  <tr>\r\n");
      out.write("\t\t   <td>&nbsp;</td>\r\n");
      out.write("\t\t  </tr>\r\n");
      out.write("\t\t  <tr>\r\n");
      out.write("\t\t   <td>&nbsp;</td>\r\n");
      out.write("\t\t  </tr>\r\n");
      out.write("\t\t</table>\r\n");
      out.write("\t\t<input type=\"hidden\" name=\"start_date\" value='");
out.write(startingDateDaily);
      out.write("'>\r\n");
      out.write("\t\t<input type=\"hidden\" name=\"end_date\" value='");
out.write(endingDateDaily);
      out.write("'>\r\n");
      out.write("\r\n");
      out.write("\t\t<table border=0\t align=\"left\" >\r\n");
      out.write("\t\t   <tr>\r\n");
      out.write("\t\t\t\t<td align=\"left\" width =\"115\">");
      out.print( pagePubHoData.getWord("Choose agent"));
      out.write(" 1</td>\n");
      out.write("\t\t\t<td align=\"left\">\r\n");
      out.write("\t\t\t<SELECT NAME=\"agent1\" onChange=\"bla(this)\">\r\n");
      out.write("\t\t\t<option>\r\n");
      out.write("\t\t\t");
 for (i = 0; i < sc.m_vAllAgents.size(); i++) {
			beanAgentLoginInfo agent = (beanAgentLoginInfo)sc.m_vAllAgents.elementAt(i);
			//String selectedValue = Integer.toString(i) + "-"+ agent.agent_id;
			
      out.write("\r\n");
      out.write("\t\t\t<OPTION VALUE=\"");
out.write(agent.agt_id);
      out.write('"');
      out.write(' ');
      out.write('>');
out.write(agent.last_name);
      out.write("&nbsp;");
out.write(agent.first_name);
      out.write("\r\n");
      out.write("\t\t\t");
}
      out.write("\r\n");
      out.write("\t\t\t</SELECT>\r\n");
      out.write("\t\t\t</td>\r\n");
      out.write("\t\t\t<td >&nbsp;</td>\r\n");
      out.write("\t\t\t<td align=\"left\" width =\"80\">");
      out.print( pagePubHoData.getWord("Choose day"));
      out.write(" </td>\n");
      out.write("\t\t\t<td align=\"left\" id=\"id_shift1\" style=\"border-left-style: none; border-left-width: 1; border-bottom-style:none; border-bottom-width:1\" >\r\n");
      out.write("\t\t\t <input type=\"text\" size=\"20\" onFocus=\"showCalendar('',this,this,'','id_shift1',0,30,1);this.blur()\" name=\"shift1\" />\r\n");
      out.write("\t\t\t</td>\r\n");
      out.write("\t\t\t<td width=600>&nbsp; </td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t<td >&nbsp;</td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t<td align=\"left\" width =\"115\">");
      out.print( pagePubHoData.getWord("Schedule"));
      out.write("</td>\n");
      out.write("\t\t\t<td colspan=\"5\"><div id=\"agent_shifts1\" style=\"MARGIN: 0px 5px\"></div></td> \r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t<td>&nbsp;</td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t\t<tr><td align=\"left\" >");
      out.print( pagePubHoData.getWord("Choose agent"));
      out.write(" 2</td>\n");
      out.write("\t\t\t   <td align=\"left\">\r\n");
      out.write("\t\t\t\t   <SELECT NAME=\"agent2\" onChange=\"bla2(this)\">\r\n");
      out.write("\t\t\t\t\t   <option>\r\n");
      out.write("\t\t\t\t\t   ");
 for (i = 0; i < sc.m_vAllAgents.size(); i++) {
					   beanAgentLoginInfo agent = (beanAgentLoginInfo)sc.m_vAllAgents.elementAt(i); 
      out.write("\r\n");
      out.write("\t\t\t\t\t   <OPTION VALUE=\"");
out.write(agent.agt_id);
      out.write('"');
      out.write('>');
out.write(agent.last_name);
      out.write("&nbsp;");
out.write(agent.first_name);
      out.write("\r\n");
      out.write("\t\t\t\t\t   ");
}
      out.write("\r\n");
      out.write("\t\t\t\t   </SELECT>\r\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t<td>&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td align=\"left\" >");
      out.print( pagePubHoData.getWord("Choose day"));
      out.write("</td>\n");
      out.write("\t\t\t\t<td align=\"left\" id=\"id_shift2\" style=\"border-left-style: none; border-left-width: 1; border-bottom-style:none; border-bottom-width:1\" >\r\n");
      out.write("\t\t\t\t <input type=\"text\" size=\"20\" onFocus=\"showCalendar('',this,this,'','id_shift2',0,30,1);this.blur()\" name=\"shift2\" />\r\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td>&nbsp;</td>\r\n");
      out.write("\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td align=\"left\">");
      out.print( pagePubHoData.getWord("Schedule"));
      out.write("</td>\n");
      out.write("\t\t\t\t<td colspan=\"5\"><div id=\"agent_shifts2\" style=\"MARGIN: 0px 5px\"></div></td>\r\n");
      out.write("\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td>&nbsp;</td>\r\n");
      out.write("\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td>\r\n");
      out.write("\t\t\t<input name=\"submitButton\" type=\"submit\" value=\"");
      out.print( pagePubHoData.getWord("Trade"));
      out.write("\" onClick=\"return trade();\"/>\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t  </table>\r\n");
      out.write("\t\t</fieldset>\r\n");
      out.write("\t</div>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t<div class=\"tab-page\" id=\"tabPage4\" >\r\n");
      out.write("\t  <h2 class=\"tab\">");
      out.print( pagePubHoData.getWord("Manual schedule"));
      out.write(" </h2>\n");
      out.write("\t   <script type=\"text/javascript\">tp1.addTabPage( document.getElementById( \"tabPage4\" ) );</script>\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t");
      out.write(" \r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");

////open connection to database///////
beanManagerData pageschedData = new beanManagerData();
System.out.println(session.getAttribute("USER_LANGUAGE"));
if( session.getAttribute("USER_LANGUAGE") != null )
	pageschedData.setDefaultLanguage((String)session.getAttribute("USER_LANGUAGE"));
pageschedData.openConnection();
    
      out.write("\r\n");
      out.write(" <script language=\"javascript\" type=\"text/javascript\">\r\n");
      out.write("// variables of labels;// \r\n");
      out.write("var sched= new Array();\r\n");
      out.write("sched[0]=\"");
      out.print( pageschedData.getWord("Time hh:mm") );
      out.write("\";\r\n");
      out.write("sched[4]=\"");
      out.print( pageschedData.getWord("Sunday"));
      out.write("\";\r\n");
      out.write("sched[5]=\"");
      out.print( pageschedData.getWord("Monday"));
      out.write("\";\r\n");
      out.write("sched[6]=\"");
      out.print( pageschedData.getWord("Tuesday"));
      out.write("\";\r\n");
      out.write("sched[7]=\"");
      out.print( pageschedData.getWord("Wednesday"));
      out.write("\";\r\n");
      out.write("sched[8]=\"");
      out.print( pageschedData.getWord("Thursday"));
      out.write("\";\r\n");
      out.write("sched[9]=\"");
      out.print( pageschedData.getWord("Friday"));
      out.write("\";\r\n");
      out.write("sched[10]=\"");
      out.print( pageschedData.getWord("Saturday"));
      out.write("\";\r\n");
      out.write("\r\n");
      out.write(" </script>\r\n");
      out.write("    \r\n");
      out.write("    \r\n");
      out.write("    \r\n");
      out.write("    \r\n");
      out.write("    ");
 pageschedData.closeConnection(); 
      out.write("\r\n");
      out.write("\t\t");
      out.write('\r');
      out.write('\n');

beanManagerData pageWeekCaData = new beanManagerData();
pageWeekCaData.openConnection();
if( session.getAttribute("USER_LANGUAGE") != null )
	pageWeekCaData.setDefaultLanguage( (String)session.getAttribute("USER_LANGUAGE") );


      out.write("\r\n");
      out.write("<script language=\"JavaScript\" type=\"text/javascript\">\r\n");
      out.write("var WeekCa= new Array();\r\n");
      out.write("\r\n");
      out.write("WeekCa[0]=\"");
      out.print( pageWeekCaData.getWord("January"));
      out.write("\";\r\n");
      out.write("WeekCa[1]=\"");
      out.print( pageWeekCaData.getWord("February"));
      out.write("\";\r\n");
      out.write("WeekCa[2]=\"");
      out.print( pageWeekCaData.getWord("March"));
      out.write("\";\r\n");
      out.write("WeekCa[3]=\"");
      out.print( pageWeekCaData.getWord("April"));
      out.write("\";\r\n");
      out.write("WeekCa[4]=\"");
      out.print( pageWeekCaData.getWord("May"));
      out.write("\";         \r\n");
      out.write("WeekCa[5]=\"");
      out.print( pageWeekCaData.getWord("June"));
      out.write("\";\r\n");
      out.write("WeekCa[6]=\"");
      out.print( pageWeekCaData.getWord("July"));
      out.write("\";\r\n");
      out.write("WeekCa[7]=\"");
      out.print( pageWeekCaData.getWord("August"));
      out.write("\";\r\n");
      out.write("WeekCa[8]=\"");
      out.print( pageWeekCaData.getWord("September"));
      out.write("\";\r\n");
      out.write("WeekCa[9]=\"");
      out.print( pageWeekCaData.getWord("October"));
      out.write("\";\r\n");
      out.write("WeekCa[10]=\"");
      out.print( pageWeekCaData.getWord("November"));
      out.write("\";\r\n");
      out.write("WeekCa[11]=\"");
      out.print( pageWeekCaData.getWord("December"));
      out.write("\";\r\n");
      out.write("WeekCa[12]=\"");
      out.print( pageWeekCaData.getWord("week"));
      out.write("\";\r\n");
      out.write("WeekCa[24]=\"");
      out.print( pageWeekCaData.getWord("Sunday"));
      out.write("\";\r\n");
      out.write("WeekCa[25]=\"");
      out.print( pageWeekCaData.getWord("Monday"));
      out.write("\";\r\n");
      out.write("WeekCa[26]=\"");
      out.print( pageWeekCaData.getWord("Tuesday"));
      out.write("\";\r\n");
      out.write("WeekCa[27]=\"");
      out.print( pageWeekCaData.getWord("Wednesday"));
      out.write("\";\r\n");
      out.write("WeekCa[28]=\"");
      out.print( pageWeekCaData.getWord("Thursday"));
      out.write("\";\r\n");
      out.write("WeekCa[29]=\"");
      out.print( pageWeekCaData.getWord("Friday"));
      out.write("\";\r\n");
      out.write("WeekCa[30]=\"");
      out.print( pageWeekCaData.getWord("Saturday"));
      out.write("\";\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("</script>\r\n");
 pageWeekCaData.closeConnection(); 
      out.write("\n");
      out.write(" \t\t");
      aheevaManager.schedule.beanAgentSchedule beanSched = null;
      synchronized (request) {
        beanSched = (aheevaManager.schedule.beanAgentSchedule) _jspx_page_context.getAttribute("beanSched", PageContext.REQUEST_SCOPE);
        if (beanSched == null){
          beanSched = new aheevaManager.schedule.beanAgentSchedule();
          _jspx_page_context.setAttribute("beanSched", beanSched, PageContext.REQUEST_SCOPE);
        }
      }
      out.write("\r\n");
      out.write("\r\n");
      out.write("\t\t<script language=\"JavaScript\" type=\"text/javascript\" src=\"../Resources_pages/schedTable.js\"></script>\r\n");
      out.write("\t\t<script language=\"JAVASCRIPT\" src=\"../Resources_pages/BaseLayer.js\"></script>\r\n");
      out.write("\t\t<LINK REL=StyleSheet HREF=\"../Resources_pages/calendar.css\" TYPE=\"text/css\">\r\n");
      out.write("\t\t<script LANGUAGE=\"JavaScript\" SRC=\"../Resources_pages/weeklycalendar.js\"></script>\r\n");
      out.write("\t\t<script LANGUAGE=\"JavaScript\" SRC=\"../Resources_pages/schedFunctions.js\"></script>\r\n");
      out.write("\r\n");
      out.write("\t\t");

		beanWorkScheduleDetails mySchedData = null;
		String sret="";
		String selected_agt_id 	  = request.getParameter("man_agent");
		String selected_agt_login = request.getParameter("man_agent_login");
		String st_date   = request.getParameter("WeeklyDateStart");
		String end_date  = request.getParameter("WeeklyDateEnd");
		String spacing   = request.getParameter("spacing");
		String startTime = request.getParameter("startTime");
		String endTime   = request.getParameter("endTime");
		
		System.out.println(" selected_agt_id ="+selected_agt_id+"  selected_agt_login="+selected_agt_login+" startTime="+startTime+" endTime="+endTime+" st_date="+st_date );
		if((selected_agt_login != null) && (selected_agt_id != null) && (selected_agt_login.length() > 0)){
			int sel = Integer.parseInt(request.getParameter("sel"));
		
      out.write("\r\n");
      out.write("\t\t\t<script>\r\n");
      out.write("\t\t\ttp1.setSelectedIndex(");
      out.print(sel);
      out.write(");</script>\r\n");
      out.write("\t\t");

		    SimpleDateFormat sdfOutput =  new SimpleDateFormat( "yyyy-MM-dd");
      		SimpleDateFormat sdfInput = new SimpleDateFormat ( "MM/dd/yy");
  			java.util.Date sDate=null,eDate=null;
      		sDate = sdfInput.parse( st_date );
			eDate = sdfInput.parse( end_date );
       		String st_date_formated=sdfOutput.format(sDate);
	       	String end_date_formated=sdfOutput.format(eDate);

		  	sret=beanSched.getAgentWorkScheduleForWfmManualSchedule(selected_agt_login,"","",st_date_formated, end_date_formated, startTime,endTime,Integer.parseInt(spacing),"Daily") ;
			System.out.println(" sret ="+sret);

			for(int cnt = 0;cnt < beanSched.m_schedDailyDetails.size();cnt++){
				  beanWorkScheduleDetails this_day_schedule_data = ((beanWorkScheduleDetails)(beanSched.m_schedDailyDetails.elementAt(cnt)));
		  
      out.write("\r\n");
      out.write("\t\t     <script>\r\n");
      out.write("\t\t\t     allAgentScheduleData[allAgentScheduleData.length]= '");
out.write(this_day_schedule_data.schedAdhDetails);
      out.write("';\r\n");
      out.write("\t\t    </script>\r\n");
      out.write("\t\t ");

		   } // end For


		}
		
      out.write("\r\n");
      out.write("\t\t<br>\r\n");
      out.write(" \t\t<fieldset id=\"schedfieldset\" style=\"height:850px; left:100px\">\r\n");
      out.write("\r\n");
      out.write("\t\t<div id='paramsDivs'  class=\"paramsDivs\" align=\"left\">\r\n");
      out.write("\t\t<legend>");
      out.print( pagePubHoData.getWord("View schedule parameters"));
      out.write(" </legend>\n");
      out.write("\t\t<table border=\"1px\" bordercolordark=\"#ffffff\" ><tr>\r\n");
      out.write("\t\t <td  bordercolor=\"#000000\">\r\n");
      out.write("\t\t\t<table border=\"0\" bordercolor=\"#999999\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\"  width=\"600\"  align=\"center\" >\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td height=\"10\" colspan=\"2\" width=\"200\"  ><a style=\"font-family:Tahoma; font-size:12px; font-weight:bold; color:#000000\">");
      out.print( pagePubHoData.getWord("Select an agent"));
      out.write("  </a></td>\n");
      out.write("\t\t\t\t<td width=\"150\" >\r\n");
      out.write("\t\t\t\t ");
      out.write("\r\n");
      out.write("\t\t\t\t <select name=\"man_agent\" class=\"paramsDivText\">\r\n");
      out.write("\t\t\t\t   <option></option>\r\n");
      out.write("\t\t\t\t   ");
 for (i = 0; i < sc.m_vAllAgents.size(); i++) {
				   beanAgentLoginInfo agent = (beanAgentLoginInfo)sc.m_vAllAgents.elementAt(i) ;
      out.write("\r\n");
      out.write("\t\t\t\t   <option value=\"");
out.write(agent.agt_id);
      out.write("\"\r\n");
      out.write("\t\t\t\t   \t\t\t\t  ");
if((selected_agt_id != null) && selected_agt_id.compareTo(agent.agt_id)==0)
									  out.write(" selected ");
      out.write(">\r\n");
      out.write("\t\t\t\t\t");
out.write(agent.last_name);
      out.write(",&nbsp;");
out.write(agent.first_name);
      out.write('[');
      out.print(agent.agt_login_id);
      out.write("]</option>\r\n");
      out.write("\t\t\t\t   ");
}
      out.write("\r\n");
      out.write("\t\t\t\t </select>\r\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t<td  width=\"43\">&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td >&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td  width=\"112\" align=\"right\">&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td  align=\"right\">&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td  width=\"112\" align=\"right\" >&nbsp;</td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t\t<!--<tr>\r\n");
      out.write("\t\t\t\t<td height=\"10\" colspan=\"2\"  ><a style=\"font-family:Tahoma; font-size:12px; font-weight:bold\">Date Picker </a></td>\r\n");
      out.write("\t\t\t\t<td ><input type=\"text\" name=\"DatePicker\" id=\"DatePicker\"></td>\r\n");
      out.write("\t\t\t\t<td ><label>\r\n");
      out.write("\t\t\t\t  <input type=\"button\"  value=\"...\" onClick=\"w_displayCalendar('DatePicker',null);\">\r\n");
      out.write("\t\t\t\t</label></td>\r\n");
      out.write("\t\t\t\t<td >&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td  align=\"right\"><a style=\"font-family:Verdana, Arial; font-size:12px; font-weight:bold\"></a></td>\r\n");
      out.write("\t\t\t\t<td  align=\"right\">&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td  align=\"right\" ></td>\r\n");
      out.write("\t\t\t</tr>-->\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td colspan=\"2\" rowspan=\"2\"><a style=\"font-family:Tahoma; font-size:12px; color:#000000; font-weight:bold\">");
      out.print( pagePubHoData.getWord("Week selector"));
      out.write("   </a></td>\n");
      out.write("\t\t\t\t<td height=\"10\" ><input type=\"text\" name=\"WeeklyDateStart\" id=\"WeeklyDateStart\"></td>\r\n");
      out.write("\t\t\t\t<td >&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td >&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td  align=\"right\">\r\n");
      out.write("\t\t\t\t\t<a style=\"font-family:Verdana, Arial; font-size:12px; font-weight:bold; color:#000000;\">");
      out.print( pagePubHoData.getWord("Starting time"));
      out.write(" </a></td>\n");
      out.write("\t\t\t\t<td  align=\"right\">&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td  align=\"right\" ><a style=\"font-family:Verdana, Arial; font-size:12px; font-weight:bold;color:#000000;\">");
      out.print( pagePubHoData.getWord("Ending time"));
      out.write("  </a></td>\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td height=\"10\" ><input type=\"text\" name=\"WeeklyDateEnd\" id=\"WeeklyDateEnd\"></td>\r\n");
      out.write("\t\t\t\t<td ><input type=\"button\"  value=\"...\" onClick=\"w_displayCalendar('WeeklyDateStart','WeeklyDateEnd');\"></td>\r\n");
      out.write("\t\t\t\t<td >&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td  align=\"right\">\r\n");
      out.write("\t\t\t\t\t<div align=\"right\">\r\n");
      out.write("\t\t\t\t\t  <select name=\"startTime\" onChange=\"setStartTime()\" class=\"paramsDivText\">\r\n");
      out.write("\t\t\t\t\t\t <script>\r\n");
      out.write("\t\t\t\t\t\t\tfillTimeBox(8);\r\n");
      out.write("\t\t\t\t\t\t </script>\r\n");
      out.write("\t\t\t\t\t  </select>\r\n");
      out.write("\t\t\t\t\t </div></td>\r\n");
      out.write("\t\t\t\t<td  align=\"right\">&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td  align=\"right\" >\r\n");
      out.write("\t\t\t\t\t<select name=\"endTime\"  onChange=\"setEndTime()\" class=\"paramsDivText\">\r\n");
      out.write("\t\t\t\t\t\t <script>\r\n");
      out.write("\t\t\t\t\t\t\tfillTimeBox(24);\r\n");
      out.write("\t\t\t\t\t\t </script>\r\n");
      out.write("\t\t\t\t\t</select>&nbsp;\r\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\r\n");
      out.write("\t\t\t<tr>\r\n");
      out.write("\t\t\t\t<td colspan=\"2\"   > <a style=\"font-family:Tahoma; font-size:12px; font-weight:bold; color:#000000;\">");
      out.print( pagePubHoData.getWord("Spacing(mn)"));
      out.write(" </a></td>\n");
      out.write("\t\t\t\t<td >\r\n");
      out.write("\t\t\t\t\t<select name=\"spacing\" onChange=\"setSpacing()\" class=\"paramsDivText\" >\r\n");
      out.write("\t\t\t\t\t\t<option value=\"15\">15 min</option>\r\n");
      out.write("\t\t\t\t\t\t<option value=\"30\">30 min</option>\r\n");
      out.write("\t\t\t\t\t\t<option value=\"60\">1 h</option>\r\n");
      out.write("\t\t\t\t\t</select>\r\n");
      out.write("\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t<td  style=\" border-bottom-width: 1; border-top-width:1\">&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td  style=\" border-bottom-width: 1; border-top-width:1\">&nbsp;</td>\r\n");
      out.write("\t\t\t\t<td  valign\"top\"  align=\"left\" >\r\n");
      out.write("\t\t\t\t<div align=\"right\">\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t<input name=\"viewSched\" type=\"button\" value=\"");
      out.print( pagePubHoData.getWord("View schedule"));
      out.write("\" onClick=\"viewScheduleTable()\"/>\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\t </div></td>\r\n");
      out.write("\t\t\t\t<td  valign\"top\"  align=\"right\" >&nbsp;<input type=\"hidden\" id=\"allsched\" name=\"allsched\" ></td>\r\n");
      out.write("\t\t\t\t<td  valign\"top\"  align=\"right\" >\r\n");
      out.write("\t<input id=\"saveSched\" name=\"saveSched\" type=\"button\" value=\"");
      out.print( pagePubHoData.getWord("Save schedule"));
      out.write("\" onClick=\"saveScheduleForWeek()\"/></td>\n");
      out.write("\r\n");
      out.write("\t\t\t</tr>\r\n");
      out.write("\t\t\t</table>\r\n");
      out.write("\t\t </td>\r\n");
      out.write("\t\t <td rowspan=\"5\" width=\"150\" nowrap=\"nowrap\" ><table><tr><td bgcolor=\"#0066FF\" width=\"10px\"></td><td><a class=\"legendText\">");
      out.print( pagePubHoData.getWord("Work manual"));
      out.write(" </a></td></tr>\n");
      out.write("\t\t \t\t\t\t\t\t<tr><td bgcolor=\"#009900\"></td><td><a class=\"legendText\">");
      out.print( pagePubHoData.getWord("Break manual"));
      out.write(" </a></td></tr>\n");
      out.write("\t\t\t\t\t\t\t\t<tr><td bgcolor=\"#663399\"></td><td><a class=\"legendText\">");
      out.print( pagePubHoData.getWord("Work schedule"));
      out.write(" </a></td></tr>\n");
      out.write("\t\t\t\t\t\t\t\t<tr><td bgcolor=\"#666666\"></td><td><a class=\"legendText\">");
      out.print( pagePubHoData.getWord("Break schedule"));
      out.write(" </a></td></tr>\n");
      out.write("\t\t\t\t\t\t\t\t<tr><td bgcolor=\"#FFFF00\"></td><td><a class=\"legendText\">");
      out.print( pagePubHoData.getWord("Cell selection"));
      out.write(" </a></tr>\n");
      out.write("\t\t\t\t\t\t</table> </td>\r\n");
      out.write("\t\t</tr></table>\r\n");
      out.write("\t\t</div>\r\n");
      out.write("\t\t<input type=\"hidden\" name=\"start_date_4\" id=\"start_date_4\" value='");
if(st_date != null) out.write(st_date);
																			else out.write(startingDateDaily);
      out.write("'>\r\n");
      out.write("\t\t<input type=\"hidden\" name=\"end_date_4\"  id=\"end_date_4\" value='");
 if(end_date != null) out.write(end_date);
																			else out.write(endingDateDaily);
      out.write("'>\r\n");
      out.write("\t\t<input type=\"hidden\" name=\"group\" value='");
out.write(agentGroup);
      out.write("'>\r\n");
      out.write("\t\t<input type=\"hidden\" name=\"groupName\" value='");
out.write(agentGroupName);
      out.write("'>\r\n");
      out.write("\t    <input type=\"hidden\" name=\"man_agent_login\" value='");
      out.print((selected_agt_login == null ? "":selected_agt_login));
      out.write("'>\r\n");
      out.write("\t    <input type=\"hidden\" name=\"sel_agt_id\" value='");
      out.print((selected_agt_id == null ? "":selected_agt_id));
      out.write("'>\r\n");
      out.write("\r\n");
      out.write("\t\t<div id=\"schedmenu\" class=\"menudiv\" onMouseOver=\"showMenuItems()\" onMouseOut=\"hideSchedMenuItems()\" align=\"center\"><table width=\"100%\" height=\"100%\" bgcolor=\"#FFFFFF\"  cellspacing=\"0\"><tr><td width=\"25px\" bgcolor=\"#CCCCCC\" align=\"center\"><img src=\"../img/sched-18.jpg\"/></td><td bgcolor=\"#FFFFFF\" align=\"center\"><a style=\"font-size:11px; font-family:Tahoma, Verdana, Arial; color:#000000; font-weight:bold\">");
      out.print( pagePubHoData.getWord("Set schedule"));
      out.write("  </a></td> <td width=\"10%\"><img src=\"../img/arrowmenu.gif\"/></td></tr></table> </div>\n");
      out.write("\r\n");
      out.write("\t\t<div id=\"menuitems1\" class=\"sousmenusched\" onClick=\"setWorkPeriod()\" align=\"center\"><table width=\"100%\" height=\"100%\" bgcolor=\"#FFFFFF\"  cellspacing=\"0\"><tr><td width=\"25px\" bgcolor=\"#CCCCCC\" align=\"center\"><img  src=\"../img/work.gif\"/></td><td bgcolor=\"#FFFFFF\"><a style=\"font-size:11px; font-family:Tahoma, Verdana, Arial; color:#000000; font-weight:bold\"  onmouseover=\"javascript:this.style.color='blue'\" onMouseOut=\"javascript:this.style.color='black'\" align=\"center\">");
      out.print( pagePubHoData.getWord("work"));
      out.write("  </a></td></tr></table> </div>\n");
      out.write("\r\n");
      out.write("\t\t<div id=\"menuitems2\"  class=\"sousmenusched\" onClick=\"setBreakPeriod()\" align=\"center\"> <table width=\"100%\" height=\"100%\" bgcolor=\"#FFFFFF\"  cellspacing=\"0\"><tr><td width=\"25px\" bgcolor=\"#CCCCCC\" align=\"center\"><img src=\"../img/lunch-schedule-16.gif\"/></td><td bgcolor=\"#FFFFFF\"><a style=\"font-size:11px; font-family:Tahoma, Verdana, Arial; color:#000000; font-weight:bold\"   onmouseover=\"javascript:this.style.color='green'\" onMouseOut=\"javascript:this.style.color='black'\" align=\"center\"> ");
      out.print( pagePubHoData.getWord("break"));
      out.write("  </a></td></tr></table></div>\n");
      out.write("\r\n");
      out.write("\t\t<div id=\"menuitems3\"  class=\"sousmenusched\" onClick=\"deletePeriod()\" align=\"center\"> <table width=\"100%\" height=\"100%\" bgcolor=\"#FFFFFF\"  cellspacing=\"0\"><tr><td width=\"25px\" bgcolor=\"#CCCCCC\" align=\"center\"><img src=\"../img/deleten.gif\"/></td><td bgcolor=\"#FFFFFF\"><a style=\"font-size:11px; font-family:Tahoma, Verdana, Arial;  color:#000000; font-weight:bold\"   onmouseover=\"javascript:this.style.color='red'\" onMouseOut=\"javascript:this.style.color='black'\" align=\"center\">");
      out.print( pagePubHoData.getWord("delete"));
      out.write("  </a></td></tr></table></div>\n");
      out.write("\r\n");
      out.write("\t\t<script>\r\n");
      out.write("\t\tschedmenuObj = document.getElementById('schedmenu');\r\n");
      out.write("\t\t//document.published.oncontextmenu = showSchedMenu;\n");
      out.write("\t\t//document.published.onclick       = hideSchedMenu;\n");
      out.write("\t\t//document.published.onmousemove   = hideSchedMenuItems;\n");
      out.write("\r\n");
      out.write("\t\t</script>\r\n");
      out.write("\t   </fieldset>\r\n");
      out.write("\t</div>\r\n");
      out.write("</div>\r\n");

	if(startTime != null){
 		out.write("<script>selectObject(document.getElementById('startTime'), '"+startTime +"');</script>");
 	}

	if(endTime != null){
 		out.write("<script>selectObject(document.getElementById('endTime'), '"+endTime +"');</script>");
 	}

	if(spacing != null){
 		out.write("<script>selectObject(document.getElementById('spacing'), '"+spacing +"'); setSpacing(); </script>");
 	}

      out.write("\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("\tsetupAllTabs();\r\n");
      out.write("\tvar stdateObj = document.getElementById('start_date_4');\r\n");
      out.write("\tif( stdateObj != null && stdateObj.value != null && stdateObj.value.length > 0)\r\n");
      out.write("\t\tsetSelectionDate(stdateObj.value);\r\n");
      out.write("\tloadtable();\r\n");
      out.write("\tdocument.getElementById('WeeklyDateStart').value = startDateValue;\r\n");
      out.write("\tdocument.getElementById('WeeklyDateEnd').value = endDateValue;\r\n");
      out.write(" </script>\r\n");
      out.write("</form>\r\n");
      out.write("</body>\r\n");
      out.write("</html>\r\n");
 pagePubHoData.closeConnection(); 
      out.write('\n');
    } catch (Throwable t) {
      if (!(t instanceof SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          out.clearBuffer();
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
      }
    } finally {
      if (_jspxFactory != null) _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
