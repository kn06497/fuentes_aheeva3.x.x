<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Routing Script</title>
<script language="JavaScript" type="text/javascript" src="jsUtil.js"></script>
<script language="javascript" type="text/javascript" src="Browser.js"></script>
<script language="javascript" type="text/javascript" src="sbr_xWriter.js"></script>
<script language="javascript" type="text/javascript" src="sbr_xparse.js"></script>
<script language="javascript" type="text/javascript" src="sbr_xReader.js"></script>
<script language="javascript" type="text/javascript" src="sbr_ast_apps.js"></script>
<script language="javascript" type="text/javascript" src="sbr_shortcuts.js"></script>
<script language="javascript" type="text/javascript" src="sbr_validationMessages.js"></script>
				<!-- Boxes -->
<script language="javascript" type="text/javascript" src="sbr_box_callconditions.js"></script>
<script language="javascript" type="text/javascript" src="sbr_box_agentpickup.js"></script>
<script language="javascript" type="text/javascript" src="sbr_box_callend.js"></script>
<script language="javascript" type="text/javascript" src="sbr_box_connexionarrow.js"></script>
<script language="javascript" type="text/javascript" src="sbr_box_priority_inc.js"></script>
<script language="javascript" type="text/javascript" src="sbr_box_pbx_exec.js"></script>
<script language="javascript" type="text/javascript" src="sbr_box_getdtmf.js"></script>
<script language="javascript" type="text/javascript" src="sbr_box_sbrquery.js"></script>
<script language="javascript" type="text/javascript" src="sbr_box_switch_case.js"></script>
<script language="javascript" type="text/javascript" src="sbr_box_counter.js"></script>
<script language="javascript" type="text/javascript" src="sbr_box_get_stat.js"></script>
<script language="javascript" type="text/javascript" src="sbr_box_customserver.js"></script>
				<!-- ~Boxes -->
<script type="text/javascript" src="sbr_milonic_src.js"></script>
<script	type="text/javascript">
if(ns4)_d.write("<scr"+"ipt type=text/javascript src=sbr_mmenuns4.js><\/scr"+"ipt>");
else _d.write("<scr"+"ipt type=text/javascript src=sbr_mmenudom.js><\/scr"+"ipt>");
</script>

<script language="javascript" type="text/javascript" src="routingScriptFunctions.js"></script>

<LINK href="style.css" rel="stylesheet" type="text/css" />
<LINK href="livestats.css" 	rel="stylesheet" type="text/css" />
</head>

<body class="bottompagebody" leftmargin="0" topmargin="0" rightmargin="0" bottommargin="0">
<div class="sbrTitle"><b><script language="javascript" type="text/javascript">document.write(tenantName);</script> ROUTING SCRIPT</b></div>

<table class="sbrBigTable"><form name="theForm">
	<tr id="IDsbrToolTR" class="sbrToolBarTR">
	<!--
		<td class="sbrToolBar">&nbsp;
	  </td>
		<td class="sbrMenu" id="ID_CallCondition" onMouseOver="changeClassTo('sbrMenuOver', this);" onMouseOut="changeClassTo('sbrMenu', this);" onClick="addCallCondition()">
			Add Call Condition Test</td>
		<td class="sbrMenu" id="ID_AgentPickup" onMouseOver="changeClassTo('sbrMenuOver', this);" onMouseOut="changeClassTo('sbrMenu', this);" onClick="addPickMethod()">
			Add Agent PickUp Method</td>
		<td class="sbrMenu" id="ID_Link" onMouseOver="changeClassTo('sbrMenuOver', this);" onMouseOut="changeClassTo('sbrMenu', this);" onClick="addCallEnding()">
			Add Call Termination</td>
		<td class="sbrMenu" id="ID_Link" onMouseOver="changeClassTo('sbrMenuOver', this);" onMouseOut="changeClassTo('sbrMenu', this);" onClick="addLink()">
			Add Link</td>
		-->
		<td>&nbsp;</td>
		<td colspan="4">
			<script type="text/javascript" src="sbr_menu_data.js"></script>
		</td>
	</tr>
	<tr bgcolor="#F0F0F0">
		<td nowrap><input name="n_script_name" style="width:60px " alt="Script Name" onChange="enableSaving()"></td>
		<td height="20" colspan="3" align="left" nowrap>
				<table cellpadding="0" cellspacing="0" width="100%">
					<tr><td nowrap>
						<img src="../img/18_new.gif" height="20" width="20" style="cursor:pointer " onClick="menu_new_script()" alt="New Script">
						<img src="../img/open.gif" height="20" width="20" style="cursor:pointer " onClick="menu_new_open()" alt="Open Script">
						<img id="saveIMG" src="../img/save_disabled.gif" height="18" width="18" style="cursor:pointer " onClick="saveThisScript()" alt="Save Diagram">
						<img src="../img/deleted.gif" width="18" height="18" style="cursor:pointer " onClick="deleteWholeDiagram()" alt="Delete whole script">
						<img src="../img/barre_vert.gif" width="3" height="23">
						<img src="../img/18_undo.gif" width="18" height="18" style="cursor:pointer " onClick="undoChanges()" alt="Undo last change">
						<img src="../img/18_redo.gif" width="18" height="18" style="cursor:pointer " onClick="redoChanges()" alt="Redo last change">
						<img src="../img/18_remove_link.gif" width="20" height="20" style="cursor:pointer " onClick="deleteArrow()" alt="Delete arrow">
						<img src="../img/eraser.gif" width="20" height="20" style="cursor:pointer " onClick="eraseDiagram()" alt="Erase diagram">
						<img src="../img/barre_vert.gif" width="3" height="23">
						<img src="../img/18_if_else.gif" width="20" height="20" style="cursor:pointer " onClick="addCallCondition()" alt="Add Call Condition">
						<img src="../img/18_switch_case.gif" width="20" height="20" style="cursor:pointer " onClick="addSwitchCase()" alt="Add Swicth">
						<img src="../img/20_user_headset.gif" width="20" height="20" style="cursor:pointer " onClick="addPickMethod()" alt="Add Agent Pickup Method">
						<img src="../img/call_up.gif" alt="Increase Call Priority" width="23" height="18" style="cursor:pointer " onClick="addPriorityInc()">
						<img src="../img/pbx_exec.gif" alt="Execute Application" width="17" height="18" style="cursor:pointer " onClick="addPbxExec()">
						<!--<img src="../img/18_onedigit.gif" alt="Get Digit" width="17" height="18" style="cursor:pointer " onClick="addGetDigit()">-->
						<img src="../img/18_string.gif" alt="Get Digit" width="17" height="18" style="cursor:pointer " onClick="addGetDigit()">
						<img src="../img/18_product.gif" alt="SQL Query" width="18" height="18" style="cursor:pointer " onClick="addSqlQuery()">
						<img src="../img/18_phone_end.gif" alt="Terminate Call"  width="18" height="18" style="cursor:pointer " onClick="addCallEnding()">
						<img src="../img/18_links.gif" alt="link Boxes" width="18" height="18" style="cursor:pointer " onClick="addLink()">
						</td>
						<td align="right" nowrap>Priority
							<select name="priority" onChange="enableSaving()"><option value=""></option>
								<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option>
								<option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option>
								<option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option>
								<option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option>
							</select>&nbsp;
						Active
						<input name="active_box" type="checkbox" alt="Activate/Desactivate" onClick="enableSaving()"></td></tr>
				</table>
	  </td>

		<td height="20" colspan="1" align="right" nowrap>
			<img src="../img/stock_zoom_in.gif" width="20" height="20" alt="Zoom in" border="0" onClick="zoomIn()" style="cursor:pointer ">
			<img src="../img/stock_zoom_out.gif" width="20" height="20" alt="Zoom out" border="0" onClick="zoomOut()" style="cursor:pointer ">
			<img src="../img/stock_zoom_fit.gif" width="20" height="20" alt="Fit" onClick="fit()" style="cursor:pointer "></td>
	</tr>
	<tr>
		<td colspan="5" class="sbrGrid" width="100%" height="100%">
		<div style="position:relative; overflow:scroll; width:100%; height:100%; top:0px; left:0px;" id="dCover"> 
          <div id="diagramInside" style="diagramClass" align="left"></div>
        </div>
		</td>
	</tr></form>
</table>


<form name="popUpForm">


<!--    _________ POPUP DIVISIONS _________     -->
	<div class="CCSetupDialog" id="CCSetupDialog">
		<table border="0" width="100%" cellpadding="0" cellspacing="0">
		  <tr>
			<td colspan="2" align="center" bgcolor="#6AA5D7"><b>Call Condition Test [Setup]</b></td>
		  </tr>
		  <tr>
			<td>Test #</td>
			<td id="CCSetupDialog_TD1">
			</td>
		  </tr>
		  <tr>
			<td>Call Property</td>
			<td>
				<select name="n_call_prop">

				</select>
			</td>
		  </tr>
		  <tr>
			<td>Operator</td>
			<td>
				<select name="n_call_link">
					<option value=""></option>
					<option value="=">=</option>
					<option value="<=">&le;</option>
					<option value="<">&lt;</option>
					<option value=">">&gt;</option>
					<option value=">=">&ge;</option>
					<option value="!=">!=</option>
					<option value="Like">Like</option>
				</select>
			</td>
		  </tr>
		  <tr>
			<td>Seek value</td>
			<td><input name="n_seek_value" type="text" size="15"></td>
		  </tr>
		  <tr>
			<td>&nbsp;</td>
			<td>

			<input name="Submit" type="button" value="Set" onClick="submitSetUpCC()">
			<input type="button" name="" value="Cancel" onClick="closeSetUpCC()"></td>
		  </tr>
		</table>
	</div>

	<div class="DTSetupDialog" id="DTSetupDialog">
		<table border="0" width="100%" cellpadding="0" cellspacing="0">
			<tr>
				<td colspan="2" align="center" bgcolor="#CCCCCC"><b>Get DTMF [Setup]</b></td>
		 	</tr>
			<tr>
				<td>ID #</td>
				<td id="DTSetupDialog_TD1">
				</td>
		 	</tr>
			<tr>
				<td><i>Data name:</i></td><td><input name="n_dtmf_data_name"></td>
			</tr>
			<tr>
				<td><i>Max Length:</i></td><td><input name="n_dtmf_max_length"></td>
			</tr>
			<tr>
				<td><i>Timeout:</i></td><td><input name="n_dtmf_timeout" size="3">s &nbsp;<i>Enders:</i> <input name="n_dtmf_enders" size="4" value="#"><td></td>
			</tr>
			<tr>
				<td><i>Default Value:</i></td><td><input name="n_dtmf_default_value"></td>
			</tr>
			<tr>
				<td><i>Voice message:</i></td><td><input name="n_dtmf_voice_mess"></td>
			</tr>
			<tr>
				<td colspan="2" align="center">
								<input name="Submit" type="button" value="Set" onClick="submitSetUpDT()">
								<input type="button" name="" value="Cancel" onClick="closeSetUpDT()">
				</td>
		 	</tr>
		</table>
	</div>


	<div class="CESetupDialog" id="CESetupDialog">
		<table border="0" width="100%" cellpadding="0" cellspacing="0">
		  <tr>
			<td colspan="2" align="center" bgcolor="#F5CDA0"><b>Call Ending [Setup]</b></td>
		  </tr>
		  <tr>
			<td>ID #</td>
			<td id="CESetupDialog_TD1">
			</td>
		  </tr>
		  <tr>
			<td>Action</td>
			<td>
				<select name="n_call_ending_action" onChange="CEDialogChange();">
					<option value=""></option>
					<option value="Hangup">Hangup</option>
					<option value="SoftHangup">SoftHangup</option>
					<option value="Transfer">Transfer</option>
					<option value="VoiceMail">VoiceMail</option>
				</select>
			</td>
		  </tr>
		  <tr>
			<td>Parameters</td>
			<td>
				<input name="n_call_ending_param">
			</td>
		  </tr>
		  <tr>
			<td>&nbsp;</td>
			<td>

			<input name="Submit" type="button" value="Set" onClick="submitSetUpCE()">
			<input type="button" name="" value="Cancel" onClick="closeSetUpCE()"></td>
		  </tr>
		</table>
	</div>


<div class="PMSetupDialog" id="PMSetupDialog">
<table border="0" width="100%" cellpadding="0" cellspacing="0">
			<tr>
				<td align="center" bgcolor="#6AA5D7"><b>Agent PickUp Method [Setup]</b></td>
		  	</tr>
			<tr>
				<td>
					<table width="100%" cellpadding="0" cellspacing="0">
						<td width="10%">ID #</td>
						<td id="PMSetupDialog_id" width="90%"></td>
					</table>
				</td>
			</tr>
			<tr>
				<td>
							<table border="0" cellspacing="0" cellpadding=""="0">
									<tr>
									<td>
									<input type="button" value="()" onClick="addThistoPMArea('()')">
									<input type="button" value="AND" onClick="addThistoPMArea(' AND ')">
									<input type="button" value="OR" onClick="addThistoPMArea(' OR ')">
									</td>
									<td>
									<select name="PMSetupDialog_AgentProps" onChange="if(this.value!='') addThistoPMArea(this.options[this.selectedIndex].text); changePMSetupInterface(this.value);">
									<option value="">&nbsp;&nbsp;-- Properties --</option>
									<option value="AgentGroup=">AgentGroup=</option>
									<option value="Agent=">Agent=</option>
									<option value="">&nbsp;&nbsp;-- Skills --</option>
									<script language="javascript" type="text/javascript">
									var allSkills = String(appletObj.getAllSkills(tenantDBID));
									allSkillsArray = allSkills.split("|");
									for(i = 0; i < allSkillsArray.length; i++)
									{
										parts = allSkillsArray[i].split(",");
										document.write('<option id="PMSetupDialog_SkillList_'+parts[0]+'" value="'+parts[0]+'">'+parts[1]+'</option>');
									}
									//alert("allSkills="+allSkills);
									</script>
									</select>
									<!-- -->
									</td>
									<td id="PMSetupDialog_optionbuttons">
									<input type="button" value="<" onClick="addThistoPMArea('&lt;')">
									<input type="button" value="=" onClick="addThistoPMArea('=')">
									<input type="button" value=">" onClick="addThistoPMArea('&gt;')">
									</td>
								</tr>
							</table>

				</td>
			</tr>
			<tr>
				<td>
				<i>Minimum required</i><br>
				<textarea name="PMSetupDialog_mininumString" style="width:100% " rows="3" ></textarea>
				</td>
			</tr>
			<tr>
				<td>
					<table width="100%" cellpadding="0" cellspacing="0">
						<tr><td align="left">
						<i>TimeOut:</i> <input name="PMSetupDialog_timeout" type="text" size="2" value="0">s &nbsp;&nbsp;&nbsp;
						</td>
						<td align="right">
						<i>Action during timeout:</i>
							<select name="PMSetupDialog_actionduringTimeout">
								<option value=""></option>
								<option value="MusicOnHold">OnHold</option>
							</select>
						  </td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td>
						<table width="100%" cellpadding="0" cellspacing="0">
						<tr><td align="left">
							<i>Tie Breaker :</i>
								<select name="PMSetupDialog_tieBreaker">
									<option value=""></option>
									<option value="MostIdle">Most Idle</option>
									<option value="LeastBusy">Least Busy</option>
								</select>
							</td><td align="right">
								<i>Call Priority :</i>
									<select name="PMSetupDialog_callPriority"><option value=""></option>
										<option value="1">1</option><option value="2">2</option>
										<option value="3">3</option><option value="4">4</option>
										<option value="5">5</option><option value="6">6</option>
										<option value="7">7</option><option value="8">8</option>
										<option value="9">9</option><option value="10">10</option>
									</select>
							</td></tr>
						</table>
				</td>
			</tr>
			<tr>
				<td>
						<table width="100%" cellpadding="0" cellspacing="0">
						<tr><td align="left">
							<i>Queue name:</i> <input name="PMSetupDialog_queuename" value="" size="8">
							</td><td align="right">
							<input type="button" name="AgentPickupUrlButton" value="Url:" onClick="changeAgentPickupUrlButton()" style="background-color:#F7F7F7; border:1px solid #000000 ">  <input name="PMSetupDialog_url" value="">
							</td>
						</tr>
						</table>
				</td>
			</tr>
			<tr>
				<td>
						<table width="100%" cellpadding="0" cellspacing="0">
							<tr>
								<td colspan="2"><br>Announcements active <input type="checkbox" name="PMSetupDialog_active_queue_announcements" onClick="activateAnnoucementOptions()"></td>
							</tr>
							<tr>
								<td width="50%">Start with announcement <input type="checkbox" name="PMSetupDialog_startwithannouncements"></td>
								<td width="50%">Frequency <input type="text" value="30" size="3" name="PMSetupDialog_announce_frequency">s</td>
							</tr>
							<tr>
								<td colspan="2">Announcement of current hold time <input type="checkbox" name="PMSetupDialog_announce_estimated_holdtime" onClick="activateAvgTimeBoxes()"></td>
							</tr>
							<tr>
								<td colspan="2"><br><i>Voice messages:</i></td>
							</tr>
							<tr>
								<td width="50%">Thank-you message<br><input type="text" name="PMSetupDialog_voicemess_thanksyouforyourpatience"></td>
								<!--<td width="50%">Message before distribute<br><input type="text" value="30" name="PMSetupDialog_voicemess_you_are"></td>-->
							</tr>
							<tr>
								<td width="50%">Current-avg-time message<br><input type="text" value="30" name="PMSetupDialog_voicemess_holdtime"></td>
								<td width="50%">Minutes message<br><input type="text" name="PMSetupDialog_voicemess_minutes"></td>
							</tr>

						</table>
				</td>
			</tr>
			<tr>
				<td align="center">
				<input name="Set" type="button" value="Set" onClick="submitSetUpPM()">&nbsp;&nbsp;
				<input name="Cancel" value="Cancel" type="button"  onClick="closeSetUpPM()">
				</td>
			</tr>
</table>
</div>

<div class="PISetupDialog" id="PISetupDialog">
	<table border="0" width="100%" cellpadding="0" cellspacing="0">
		<tr>
			<td align="center" bgcolor="#DCEBC7" colspan="2"><b>Priority Increment[Setup]</b></td>
		</tr>
		<tr>
				<td>ID #</td>
				<td id="PISetupDialog_id"></td>
		</tr>
		<tr>
			<td>Add</td>
			<td>
				<select name="PISetupDialog_callIncrement">
					<option value=""></option>
					<option value="1">+1</option><option value="2">+2</option>
					<option value="3">+3</option><option value="4">+4</option>
					<option value="5">+5</option><option value="6">+6</option>
					<option value="7">+7</option><option value="8">+8</option>
					<option value="9">+9</option><option value="10">+10</option>
				</select>
			</td>
		</tr>
		<tr>
			<td align="center" colspan="2"><input name="Set" type="button" value="Set" onClick="submitSetUpPI()">&nbsp;&nbsp;
				<input name="Cancel" value="Cancel" type="button"  onClick="closeSetUpPI()">
		  </td>
	  </tr>
	</table>
</div>



<div class="PESetupDialog" id="PESetupDialog">
	<table border="0" width="100%" cellpadding="1" cellspacing="0">
		<tr>
			<td align="center" bgcolor="#C8D6D7" colspan="2"><b>Applications Execute[Setup]</b></td>
		</tr>
		<tr>
				<td>ID #</td>
				<td id="PESetupDialog_id"></td>
		</tr>
		<tr>
			<td valign="top" width="35%">Selected Apps</td>
			<td align="left">
				<img src="../img/add.gif" width="16" height="16" class="img1" alt="Add Application" onClick="addAppToList()">
				<img src="../img/delete2.gif" width="16" height="16" class="img1" alt="Remove Application" onClick="removeAppFromList()">
				<img src="../img/arrowUp.gif" width="16" height="16" class="img1" alt="Move Application Up" onClick="moveAppUp()">
				<img src="../img/arrow_down.gif" width="16" height="16" class="img1" alt="Move Application Down" onClick="moveAppDown()">
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<select name="PESetupDialog_SelectsAppsList" size="5" style="width:100% "></select>
			</td>
		</tr>

		<tr>
			<td>Available Apps</td>
			<td>
				<select name="PESetupDialog_list_of_apps" style="width:100% " onChange="showAstAppsDescr()">
					<script language="javascript" type="text/javascript">
						var ast_app;
						for(ast_app in ast_apps_list)
						{
							document.write("<option value=\""+ast_app+"\">"+ast_app+"</option>");
						}
					</script>
				</select>
			</td>
		</tr>
		<tr>
			<td class="PESetupAppDescr" id="PESetupDialog_descr"></td>
			<td valign="top">
				Parameters<br>
				<input name="PESetupDialog_AppParams">
			</td>
		</tr>

		<tr>
			<td align="center" colspan="2"><input name="Set" type="button" value="Set" onClick="submitSetUpPE()">&nbsp;&nbsp;
				<input name="Cancel" value="Cancel" type="button"  onClick="closeSetUpPE()">
		  </td>
	  </tr>
	</table>
</div>

<div class="SQSetupDialog" id="SQSetupDialog">
		<table border="0" width="100%" cellpadding="0" cellspacing="0">
			<tr>
				<td colspan="2" align="center" bgcolor="#DECAB6"><b>Database Query [Setup]</b></td>
		 	</tr>
			<tr>
				<td width="25%">ID #</td>
				<td id="SQSetupDialog_TD1">
				</td>
		 	</tr>
			<tr>
				<td colspan="2"><i>Call Properties</i>
				<select name="SQSetupDialog_callprop" onChange="addTextToSQLField();">

				</select>

				</td>
			</tr>
			<tr>
				<td colspan="2"><i>MySQL Query</i><br>
				<textarea name="SQSetupDialog_sql_query" style="width:100% " rows="3" ></textarea>

				</td>
			</tr>
			<tr>
				<td colspan="2" align="right"><i>Result Name:</i><input type="text" name="SQSetupDialog_varname">
				</td>
			</tr>
			<tr>
			<td align="center" colspan="2"><input name="Set" type="button" value="Set" onClick="submitSetUpSQ()">&nbsp;&nbsp;
					<input name="Cancel" value="Cancel" type="button"  onClick="closeSetUpSQ()">
			  </td>
	  		</tr>
		</table>
</div>


<div class="SCSetupDialog" id="SCSetupDialog">
	<table border="0" width="100%" cellpadding="1" cellspacing="0">
		<tr>
			<td align="center" bgcolor="#E8E0DB" colspan="2"><b>Switch Statement[Setup]</b></td>
		</tr>
		<tr>
				<td>ID #</td>
				<td id="SCSetupDialog_id"></td>
		</tr>
		<tr>
			<td>Properties</td>
			<td>
				<select name="n_call_prop2">

				</select>
			</td>
	  </tr>
		<tr>
			<td valign="top" width="35%">Values</td>
			<td align="left">
				<img src="../img/add.gif" width="16" height="16" class="img1" alt="Add Application" onClick="addSCValueToList()">
				<img src="../img/delete2.gif" width="16" height="16" class="img1" alt="Remove Application" onClick="removeSCValueFromList()">
				<img src="../img/arrowUp.gif" width="16" height="16" class="img1" alt="Move Application Up" onClick="moveSCValueUp()">
				<img src="../img/arrow_down.gif" width="16" height="16" class="img1" alt="Move Application Down" onClick="moveSCValueDown()">
			</td>
		</tr>
		<tr>
			<td></td>
			<td>
				<select name="SCSetupDialog_SelectsSCValuesList" size="5" style="width:100% "></select>
			</td>
		</tr>

		<tr>
			<td>Operators</td>
			<td>
				<select name="SCSetupDialog_list_of_SCValues">
					<option value=""></option>
					<option value="=">=</option>
					<option value="<=">&le;</option>
					<option value="<">&lt;</option>
					<option value=">">&gt;</option>
					<option value=">=">&ge;</option>
					<option value="!=">!=</option>
					<option value="Like">Like</option>
				</select>
			</td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td valign="top">
				Parameters<br>
				<input name="SCSetupDialog_SCValueParams">
			</td>
		</tr>

		<tr>
			<td align="center" colspan="2"><input name="Set" type="button" value="Set" onClick="submitSetUpSC()">&nbsp;&nbsp;
				<input name="Cancel" value="Cancel" type="button"  onClick="closeSetUpSC()">
		  </td>
	  </tr>
	</table>
</div>


<div class="COSetupDialog" id="COSetupDialog">
		<table border="0" width="100%" cellpadding="0" cellspacing="0">
			<tr>
				<td colspan="2" align="center" bgcolor="#E1E8E3"><b>Counter [Setup]</b></td>
		 	</tr>
			<tr>
				<td>ID #</td>
				<td id="COSetupDialog_TD1">
				</td>
		 	</tr>
			<tr>
				<td><i>Data name:</i></td><td><input name="n_counter_data_name" value=""></td>
			</tr>
			<tr>
				<td><i>Attached To:</i></td><td>
					<input type="radio" name="n_conunter_attached_to" value="ROUTING_SCRIPT" onClick="disableTacker(0)">Routing Script
					<input type="radio" name="n_conunter_attached_to" value="CALL" onClick="disableTacker(1)">Call
				</td>
			</tr>
			<tr>
				<td>&nbsp;</td><td><input type="checkbox" name="n_counter_track">Show Statistics<td></td>
			</tr>
			<tr>
				<td colspan="2" align="center">
								<input name="Submit" type="button" value="Set" onClick="submitSetUpCO()">
								<input type="button" name="" value="Cancel" onClick="closeSetUpCO()">
								<input type="button" name="" value="Reset" onClick="ResetThisCounterStats()">
				</td>
		 	</tr>
		</table>
</div>




<div class="GSSetupDialog" id="GSSetupDialog">
<table border="0" width="100%" cellpadding="0" cellspacing="0">
			<tr>
				<td align="center" bgcolor="#D1D8C2"><b>Get Statistic [Setup]</b></td>
		  	</tr>
			<tr>
				<td>
					<table width="100%" cellpadding="0" cellspacing="0">
						<td width="10%">ID #</td>
						<td id="GSSetupDialog_id" width="90%"></td>
					</table>
				</td>
			</tr>
			<tr>
				<td>
					<table width="100%" cellpadding="0" cellspacing="0">
						<td width="10%">Type:&nbsp;</td>
						<td width="90%">
							<select name="GSSetupDialog_Type" onChange="changeGSDataText(this.value); ">
								<option value="">-- Queues Statistics--</option>
								<option value="QUEUE_WAITING_CALLS">&nbsp;&nbsp;&nbsp;&nbsp;Waiting Calls</option>
								<option value="QUEUE_ENTERED_CALLS">&nbsp;&nbsp;&nbsp;&nbsp;Calls Entered</option>
								<option value="QUEUE_DISTRIBUTED_CALLS">&nbsp;&nbsp;&nbsp;&nbsp;Calls Distributed</option>
								<option value="QUEUE_ABANDONNED_CALLS">&nbsp;&nbsp;&nbsp;&nbsp;Abandonned Calls</option>
								<option value="QUEUE_LONGUESTWAITING_CALL">&nbsp;&nbsp;&nbsp;&nbsp;Longuest Waiting Call</option>
								<option value="QUEUE_SERVICE_FACTOR">&nbsp;&nbsp;&nbsp;&nbsp;Service Factor</option>
								<option value="QUEUE_CURRENT_AVG_WAITING_TIME">&nbsp;&nbsp;&nbsp;&nbsp;Current Avg Waiting Time</option>
								<option value="QUEUE_AVG_WAITING_TIME">&nbsp;&nbsp;&nbsp;&nbsp;Avg Waiting Time</option>
								<option value="">-- Agents Statistics--</option>
								<option value="GROUP_TOTAL_WAITING_AGENTS">&nbsp;&nbsp;&nbsp;&nbsp;Waiting Agents</option>
								<option value="GROUP_TOTAL_LOGIN_AGENTS">&nbsp;&nbsp;&nbsp;&nbsp;Login Agents</option>
								<option value="GROUP_TOTAL_CONFIGURED_AGENTS">&nbsp;&nbsp;&nbsp;&nbsp;Configured Agents</option>
								<!--<option value="GROUP_BUSY_FACTOR_GROUP">&nbsp;&nbsp;&nbsp;&nbsp;Busy Factor</option>-->
							</select>
						</td>
					</table>
				</td>
			</tr>
			<tr>
				<td id="GSSetupDialog_operators_td">
					<script>
						GSSetupDialog_operators_table = '<table border="0" cellspacing="0" cellpadding=""="0">';
						GSSetupDialog_operators_table += '<tr>';
						GSSetupDialog_operators_table += '<td>';
						GSSetupDialog_operators_table += '<input type="button" value="()" onClick="addThistoGSArea(\'()\')">';
						GSSetupDialog_operators_table += '<input type="button" value="AND" onClick="addThistoGSArea(\' AND \')">';
						GSSetupDialog_operators_table += '<input type="button" value="OR" onClick="addThistoGSArea(\' OR \')">';
						GSSetupDialog_operators_table += '</td>';
						GSSetupDialog_operators_table += '<td>';
						GSSetupDialog_operators_table += '<select name="GSSetupDialog_AgentProps" onChange="if(this.value!=\'\') addThistoGSArea(this.options[this.selectedIndex].text); changeGSSetupInterface(this.value);">';
						GSSetupDialog_operators_table += '<option value="">&nbsp;&nbsp;-- Properties --</option>';
						GSSetupDialog_operators_table += '<option value="AgentGroup=">AgentGroup=</option>';
						GSSetupDialog_operators_table += '<option value="">&nbsp;&nbsp;-- Skills --</option>';
						var allSkills = String(appletObj.getAllSkills(tenantDBID));
						if(allSkills.length != 0)
						{
							var allSkillsArray = allSkills.split("|");
							for(var i = 0; i < allSkillsArray.length; i++)
							{
								parts = allSkillsArray[i].split(",");
								GSSetupDialog_operators_table += '<option id="GSSetupDialog_SkillList_'+parts[0]+'" value="'+parts[0]+'">'+parts[1]+'</option>';
							}
						}
						GSSetupDialog_operators_table += '</select>';
						GSSetupDialog_operators_table += '<!-- -->';
						GSSetupDialog_operators_table += '</td>';
						GSSetupDialog_operators_table += '<td id="GSSetupDialog_optionbuttons">';
						GSSetupDialog_operators_table += '<input type="button" value="<" onClick="addThistoGSArea(\'&lt;\')">';
						GSSetupDialog_operators_table += '<input type="button" value="=" onClick="addThistoGSArea(\'=\')">';
						GSSetupDialog_operators_table += '<input type="button" value=">" onClick="addThistoGSArea(\'&gt;\')">';
						GSSetupDialog_operators_table += '</td>';
						GSSetupDialog_operators_table += '</tr>';
						GSSetupDialog_operators_table += '</table>';

						document.write(GSSetupDialog_operators_table);
					</script>

				</td>
			</tr>
			<tr>
				<td id="GSSetupDialog_data_text"></td>
			</tr>
			<tr>
				<td>
				<textarea name="GSSetupDialog_data" style="width:100% " rows="3" ></textarea>
				</td>
			</tr>
			<tr>
				<td>
					Variable name: <input name="GSSetupDialog_variable_name" value="" size="20">
				</td>
			</tr>
			<tr>
				<td align="center">
				<input name="Set" type="button" value="Set" onClick="submitSetUpGS()">&nbsp;&nbsp;
				<input name="Cancel" value="Cancel" type="button"  onClick="closeSetUpGS()">
				</td>
			</tr>
</table>
</div>


<div class="CSSetupDialog" id="CSSetupDialog">
		<table border="0" width="100%" cellpadding="0" cellspacing="0">
		  <tr>
			<td colspan="2" align="center" bgcolor="#F0D7CA"><b>Custom Server [Setup]</b></td>
		  </tr>
		  <tr>
			<td>ID #</td>
			<td id="CSSetupDialog_TD1">
			</td>
		  </tr>
		  <tr>
			<td>Library</td>
			<td>
				<select name="n_custom_server_module" onChange="CSChangeModule(this.value);">
				</select>
			</td>
		  </tr>
		  <tr>
		  	<td>Function</td>
			<td>
				<select name="n_custom_server_function">
				</select>
			</td>
		  </tr>
		  <tr>
			<td>Parameters</td>
			<td>
				<input name="n_custom_server_param">
			</td>
		  </tr>
		  <tr>
			<td>&nbsp;</td>
			<td>

			<input name="Submit" type="button" value="Set" onClick="submitSetUpCS()">
			<input type="button" name="" value="Cancel" onClick="closeSetUpCS()"></td>
		  </tr>
		</table>
	</div>

<!--    _________ OTHER DIVISIONS _________     -->

<div class="TempMessages" id="TempMessages">
	<table border="0" width="100%" cellpadding="0" cellspacing="0" height="100%">
		<tr>
			<td width="100%" id="TempMsg" align="center" class="TempMsg">
			</td>
		</tr>
	</table>
</div>


<div class="extraDataMess" id="extraDataMess">
		<table border="0" width="100%" cellpadding="0" cellspacing="0" height="100%">
			<tr>
				<td width="100%" align="center" class="extraData" bgcolor="#FFFFFF">
					Enter extra data name:<br>
					<input name="n_extra_data" value=""><br>
					<input type="button" value="Add" class="button1" onClick="addAddExtraData(document.popUpForm.n_extra_data.value)">&nbsp;&nbsp;<input type="button" value="Cancel" onClick="cancelAddExtraData()" class="button1">
				</td>
			</tr>
		</table>
</div>
<div class="CallPropertiesManager" id="CallPropertiesManager">
		<table border="0" width="100%" cellpadding="0" cellspacing="2">
			<tr>
				<td class="CallPropertiesManager1" align="center">Call Properties</td>
			</tr>
			<tr>
				<td>Available properties<br>
					<select name="available_call_props" size="5" style=" width:100%"></select>
				</td>
			</tr>
			<tr>
			  <td>
					New property<br>
					<input type="text" name="new_call_property"><input type="button" class="grayButton" value="ADD" onClick="addNewCallProperty()">
		      </td>
			</tr>
			<tr>
			  <td align="center">
					<input type="button" class="grayButton" value="&nbsp;&nbsp;Close&nbsp;&nbsp;" onClick="closeCallPropertiesManager()">
			  </td>
			</tr>
		</table>
</div>
<div class="OpenScript" id="OpenScript">
		<table border="0" width="100%" cellpadding="0" cellspacing="2">
			<tr>
				<td class="CallPropertiesManager1" align="center">Open Script</td>
			</tr>
			<tr>
				<td>Scripts<br>
					<select name="open_script_scripts" size="5" style=" width:100%"></select>
				</td>
			</tr>
			<tr>
			  <td align="center">
			  		<input type="button" class="grayButton" value="&nbsp;&nbsp;Open&nbsp;&nbsp;" onClick="OpenThisScript()">
					&nbsp;&nbsp;
					<input type="button" class="grayButton" value="&nbsp;&nbsp;Cancel&nbsp;&nbsp;" onClick="closeOpenScript()">
			  </td>
			</tr>
		</table>
</div>
<div class="SaveScriptAs" id="SaveScriptAs">
		<table border="0" width="100%" cellpadding="0" cellspacing="2">
			<tr>
				<td class="CallPropertiesManager1" align="center">Save Script As</td>
			</tr>
			<tr>
				<td>Script Name<br>
					<input type="text" name="save_as_text" value="">
					<select name="save_as_scripts" size="5" style=" width:100%" onChange="document.popUpForm.save_as_text.value=this.options[this.selectedIndex].text"></select>
				</td>
			</tr>
			<tr>
			  <td align="center">
			  		<input type="button" class="grayButton" value="&nbsp;&nbsp;Save As&nbsp;&nbsp;" onClick="SaveThisAsScript()">
					&nbsp;&nbsp;
					<input type="button" class="grayButton" value="&nbsp;&nbsp;Cancel&nbsp;&nbsp;" onClick="closeSaveScriptAs()">
			  </td>
			</tr>
		</table>
</div>

<div class="ScriptStats" id="ScriptStats">
		<table border="0" width="100%" height="100%" cellpadding="0" cellspacing="0">
			<tr height="10">
				<td class="ScriptStats_title" id="ScriptStats_title" bgcolor="#3366CC"></td>
			</tr>
			<tr>
				<td valign="top">
					<div style="overflow:scroll " id="ScriptStats_inside">


					</div>
				</td>
			</tr>
			<tr height="10">
			  <td align="center">
			  		<input type="button" class="grayButton" value="&nbsp;&nbsp;Close&nbsp;&nbsp;" onClick="closeScriptStats()">
			  </td>
			</tr>
		</table>
</div>

<div class="validationDiv" id="validationDiv">
		<table border="0" width="100%" height="100%" cellpadding="0" cellspacing="0">
			<tr height="10">
				<td bgcolor="#F2F2F2" align="center">Whole Script Validation</td>
			</tr>
			<tr>
				<td valign="top">
					<div style="overflow:auto; width:100%; height:150 " id="validationDiv_inside">


					</div>
				</td>
			</tr>
			<tr height="10">
			  <td align="center">
			  		<input type="button" class="grayButton" value="&nbsp;&nbsp;Close&nbsp;&nbsp;" onClick="closeValidationDiv()">
			  </td>
			</tr>
		</table>
</div>

<div class="helppopDiv" id="helppopDiv">
	<table>
		<tr><td><iframe src="sbr_help.htm"></iframe></td></tr>
		<tr><td align="center"><input type="button" class="grayButton" value="&nbsp;&nbsp;Close&nbsp;&nbsp;" onClick="hideHelp()"></td></tr>
	</table>
</div>
</form>

<!-- This IFrame is use to hide other -->
<IFRAME id="iframe_masque" name="iframe_masque"
style="position:absolute;display:none;" frameborder=0 scrolling=no marginwidth=0 src="" marginheight=0>
</iframe>




<!-- -->
<script language="javascript" type="text/javascript">
	var curSkillString = String(appletObj.getRoutingScript(script_dbid));
	//var curSkillString = "";
	String_to_Schema(curSkillString);

	refreshDiagramInside();
	document.theForm.n_script_name.value = script_name;
	if(script_is_active == '1')
		document.theForm.active_box.checked = true;
	else
		document.theForm.active_box.checked = false;
	chooseSelectObj("priority", script_priority);

	setupCustomServerModulesFucntions();

</script>
</body>

</html>
