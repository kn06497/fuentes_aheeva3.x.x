<html>
<head>

<LINK href="Resources_pages/style.css" type=text/css rel=stylesheet>
<script>
var curAgent=''; // DBID
var curAgentId =''; //agent_id

function updateEvaluationFormOption()
{
	if(eval_option.value == 'ON'){
		eval_form.disabled = false;
		var allEvaluationForm = window.top.comm.myApplet.getEvaluationForm();
		var arrayEvaluationForm = new Array;
		arrayEvaluationForm = allEvaluationForm.split("|");
		eval_form.options.length = 0;
		for(i=0;i<arrayEvaluationForm.length;i+=2)
		{
			eval_form.options[i/2] = new Option(arrayEvaluationForm[i],arrayEvaluationForm[i+1]);
		}
	}else{
	    eval_form.disabled = true;
	}
}

function moveYear()
{   var nextyear = 0
    var yy=year.value;
	if(moveYear.arguments[0] == 'back')
		nextyear = parseInt(yy,10) - 1;
	else
		nextyear = parseInt(yy,10) + 1;
	year.value = nextyear;
    displayAgentSchedule();
}

function getCurYear()
{
	now = new Date();
	yy=String(now.getYear())
	year.value = yy;
	return yy;
}

function getCurMonth()
{
	now = new Date();
	mm=now.getMonth()+1;
	for(i=0; i<month.options.length; i++)
		if(month.options[i].value == mm)
			month.options[i].selected = true;
}

function getCurDate()
{
	getCurYear();
	getCurMonth();
}

function getCurDateAndReload()
{
	getCurDate();
	displayAgentSchedule();

}
function displayAgentSchedule(){
  var starttime = bdate.value
  var endtime = edate.value
  var colspace = spacing.value
  var agt = curAgent
  //alert(starttime+'..'+endtime+'..'+colspace+'..'+agt)
  var loc = "./jsp/videoAgent.jsp?agt=";
      loc += curAgent;
      loc += "&st=" + starttime + "&et=" + endtime +"&cols=" + colspace;
      loc += "&mm=" + month.value + "&yy=" + year.value+"&agt_id="+curAgentId;
   //alert("location from top.htm displayAgentSchedule : "+ loc);
  //alert("top.htm["+loc+"]");
  //loc = "./jsp/agent.jsp?agt=101&st=&et=&cols=&mm=&yy="
  //alert(loc);
  window.top.rmiddle.location =loc;
  reloadMenu();
}

function reloadMenu()
{
 if (window.top.left != null)
   window.top.left.location = "./VideoRecordingMenu.htm?user=1&tenant_dbid=1"
}
</script>
</head>

<!-- <base target="rbottom"> -->

<body class="toppanel" scrolling="yes" topmargin="4" >
<table  border="1" >
  <tr>
   <td colspan="6"><APPLET CODE="Manager.java.PlayerApplet.class"
	ARCHIVE="sManager.jar,jmf.jar"
        NAME="myPlayer"
	width=480 height=28>
        <param name=file value="playme.wav">
      </APPLET></td>
    <td width="158"><select name="eval_option" onChange="updateEvaluationFormOption()">
        <option value="ON">Evaluation ON</option>
        <option selected value="OFF">Evaluation OFF</option>
      </select></td>
    <td width="151" ><select name="eval_form" disabled>
      </select></td>
  </tr>
  <tr>
    <td width="28" height="28"  valign="middle"><div align="center" > <a href="javascript:getCurDateAndReload()"><img src="img/cal.gif" width="20" height="20" border="0" onClick=""></a>
        <!--<input name="curDate" type="button" id="curDate" value="O">-->
      </div>
      <div align="right"> </div>
      <div align="center"> </div></td>
    <td width="73"><div align="center"> </div>
      <div align="center">
        <select name="bdate" size="1" onChange="displayAgentSchedule()">
		  <option value="00:00:00">0h00</option>
		  <option value="01:00:00">1h00</option>
		  <option value="02:00:00">2h00</option>
		  <option value="03:00:00">3h00</option>
		  <option value="04:00:00">4h00</option>
		  <option value="05:00:00">5h00</option>
		  <option value="06:00:00">6h00</option>
          <option value="07:00:00">7h00</option>
          <option value="08:00:00">8h00</option>
          <option selected value="09:00:00">9h00</option>
          <option value="10:00:00">10h00</option>
          <option value="11:00:00">11h00</option>
          <option value="12:00:00">12h00</option>
          <option value="13:00:00">13h00</option>
          <option value="14:00:00">14h00</option>
          <option value="15:00:00">15h00</option>
          <option value="16:00:00">16h00</option>
          <option value="17:00:00">17h00</option>
          <option value="18:00:00">18h00</option>
          <option value="19:00:00">19h00</option>
          <option value="20:00:00">20h00</option>
          <option value="21:00:00">21h00</option>
          <option value="23:00:00">23h00</option>

        </select>
      </div></td>
    <td width="72"> <div align="center">
        <select name="edate" size="1" onChange="displayAgentSchedule()">
		  <option value="00:00:00">0h00</option>
		  <option value="01:00:00">1h00</option>
		  <option value="02:00:00">2h00</option>
		  <option value="03:00:00">3h00</option>
		  <option value="04:00:00">4h00</option>
		  <option value="05:00:00">5h00</option>
		  <option value="06:00:00">6h00</option>
          <option value="07:00:00">7h00</option>
          <option value="08:00:00">8h00</option>
          <option value="09:00:00">9h00</option>
          <option value="10:00:00">10h00</option>
          <option value="11:00:00">11h00</option>
          <option value="12:00:00">12h00</option>
          <option value="13:00:00">13h00</option>
          <option value="14:00:00">14h00</option>
          <option value="15:00:00">15h00</option>
          <option value="16:00:00">16h00</option>
          <option value="17:00:00">17h00</option>
          <option value="18:00:00">18h00</option>
          <option value="19:00:00">19h00</option>
          <option value="20:00:00">20h00</option>
          <option selected value="21:00:00">21h00</option>
          <option value="23:00:00">23h00</option>
        </select>
      </div></td>
    <td width="53"><div align="center">
        <select name="spacing" size="1" onChange="displayAgentSchedule()">
          <option value="15" selected>15</option>
          <option value="60">60</option>
        </select>
      </div></td>
    <td width="133">&nbsp; </td> <!--<b>&lt;</b> <b>&gt;</b>-->
    <td width="91" align="center" valign="middle">
      <a href="javascript:moveYear('back')" onMouseOver="window.status=' ';return true;">
	  <img src="img/fleche_gauche1.jpg" width="16" height="16" border="0"></a>
      <input name="year" size="4"  readonly="true" type="text">
      <a href="javascript:moveYear('forward')">
	  <img src="img/fleche_droite1.jpg" width="16" height="16" border="0" ></a> </td>
    <td colspan="2"><select name="month" size="1" onChange="displayAgentSchedule()">
        <option value="01" selected>January</option>
        <option value="02">February</option>
        <option value="03">March</option>
        <option value="04">April</option>
        <option value="05">May</option>
        <option value="06">June</option>
        <option value="07">July</option>
        <option value="08">August</option>
        <option value="09">September</option> 
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
      </select></td>
  </tr>
</table>
<script>
	getCurDate()
</script>
</body>
</html>

